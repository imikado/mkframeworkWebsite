<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="site/css/bootstrap.min_v2.css" />
    
 
    <title>MkFramework</title>
 <link rel="stylesheet" type="text/css" href="site/css/main.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="site/css/jumbotron.css" media="screen" />


  
<script src="site/js/main.js" type="text/javascript"></script>

<link rel="alternate" type="application/rss+xml" title="RSS" href="news.rss"/>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34332613-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<style>
.container2{
margin-top:40px;

}
</style>
</head>
<body>

<style>
.navbar .navbar-brand{
background: url('site/css/images//logoMk.png') no-repeat 0px 0px ;
padding-left:60px;
}
</style>

<nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark">
	<a class="navbar-brand" href="#">MKFramework</a>
	<button class="navbar-toggler p-0 border-0" type="button" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="navbar-toggler-icon"></span>
	</button>
	
 

	<div class="navbar-collapse collapse"  >
		<ul class="navbar-nav mr-auto">
		
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="accueil.html">Accueil <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="news.html">Le site <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="fonctionnement.html">Pr&eacute;sentation <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item active">
					<a  class="nav-link" href="start.html">Documentation <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="publishonweb.html">Publications <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="telecharger.html">T&eacute;l&eacute;charger <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a target="_blank" class="nav-link" href="http://www.developpez.net/forums/f1355/applications/projets/projets-heberges/mkframework/">Forum <span class="sr-only">(current)</span></a>
				</li>
			
				
				
						
			
          
		</ul>
		
		<ul class="navbar-nav  navbar-right">
						<li class="nav-item"><a class="nav-link" style="font-weight:bold" href="tutoriaux.html">FR</a></li>

			<li><a class="nav-link"  href="tutoriaux_en.html">EN</a></li>
		</ul>
		
	</div>
</nav>
 <style>
 .navbar-custom {
    background-color: #124c5c;
}</style>
<nav class="navbar navbar-expand-md  navbar-custom navbar-dark">
	 

	<div class="navbar-collapse collapse"  >
		<ul class="navbar-nav mr-auto">
	
			
	
				
			
			<li class="nav-item ">
				<a class="nav-link" href="start.html" >D&eacute;marrer <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item active">
				<a class="nav-link" href="#" >Tutoriaux <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="bigtutoriaux.html" >Gros Tutoriaux <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
					
			
			<li class="nav-item ">
				<a class="nav-link" href="screencasts.html" >Tutotoriaux vid&eacute;os <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
					
			
			<li class="nav-item ">
				<a class="nav-link" href="bestpractices.html" >Bonnes pratiques <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="slides.html" >Slides <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="api.html" >L'API <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="faq.html" >FAQ <span class="sr-only">(current)</span></a>
			</li>
		
			
			
		  
  
         
	</ul>
</div>
</nav>


    
      <main role="main">
      
		<div class="container container2">
	 
		<h1>Tutoriaux</h1><h2>En utilisant le builder</h2><a href="#newsite">Cr&eacute;er un nouveau site </a><br /><a href="#model">Cr&eacute;er la couche mod&egrave;le de votre site </a><br /><a href="#menu">Ajouter un menu &agrave; votre site </a><br /><a href="#menubootstrap">Ajouter un menu vertical &agrave; votre site [Bootstrap] </a><br /><a href="#auth2">Ajouter une authentification</a><br /><a href="#auth2b">Enrichir le module d&#039;authentification</a><br /><a href="#crud">Cr&eacute;er un module CRUD (Create Read Update Delete) </a><br /><a href="#crudembedded">Cr&eacute;er un module CRUD int&eacute;grable (Create Read Update Delete) </a><br /><a href="#crudguriddo">Cr&eacute;er un module CRUD avec Guriddo (Create Read Update Delete) </a><br /><a href="#crudmulti">Cr&eacute;er un module CRUD multi-ligne (Create Read Update Delete) </a><br /><a href="#aclmultigroupes">Ajouter une gestion de permissions multi-groupes (ACL) </a><br /><a href="#crudandcrudembedded">Cr&eacute;er pour 2 tables: deux modules CRUD et int&eacute;grable li&eacute;s </a><br /><br /><br /><h2>Sans utiliser le builder</h2><a href="#auth">Ajouter une authentication &agrave; une page/un module </a><br /><a href="#upload">Permettre l&#039;upload d&#039;un fichier </a><br /><a href="#formulaire">V&eacute;rifier les entr&eacute;es d&#039;un formulaire </a><br /><a href="#ajoutcheck">Ajouter une verification particuliere </a><br /><a href="#ajoutcheck2">Ajouter une verification ponctuelle </a><br /><a href="#formulaireplugin">Facilitez la cr&eacute;ation de formulaire </a><br /><a href="#acl">G&eacute;rer des permissions (ACL) </a><br /><a href="#usecrudembedded">Utilisez des CRUD int&eacute;grables </a><br /><a href="#token">Utiliser les jetons pour &eacute;viter les failles XSRF </a><br /><a href="#cachesite">Faire un site avec un cache html complet </a><br /><a href="#debug">Utiliser la barre de debug </a><br /><a href="#webservice">Faire un webservice </a><br /><a href="#listelinked">Faire des menus d&eacute;roulants li&eacute;s </a><br /><a href="#phpexcel">Generer des fichiers excel avec PhpExcel </a><br /><a href="#multiStep">Formulaire multi-step </a><br /><a href="#mdpoublie">Mot de passe oubli&eacute; </a><br /><br /><br /><h2>Etendre le framework</h2><a href="#zf1">Utiliser des classes Zend Framework 1 </a><br /><a href="#zf2">Utiliser des classes Zend Framework 2 </a><br /><a href="#zf3">Utiliser des classes Zend Framework 3 </a><br /><a href="#sf4">Utiliser des classes Symfony 4 </a><br /><a href="#tableguriddo">Impl&eacute;menter un tableau Guriddo </a><br /><br /><a href="faq.html">Une question ? la FAQ est l&agrave; pour &ccedil;a </a><br /><br /><br /><p><a id="newsite" name="newsite"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er un nouveau site</h1><h2>Installation</h2>T&eacute;l&eacute;charger le mkframework en cliquant sur le lien situ&eacute; sur le site. Vous recuperez une archive au format zip.<br />D&eacute;compressez la dans le repertoire web de votre serveur apache, (repertoire www/ ou htdocs/ selon votre environnement)<br />Dans ce tutoriel, on part du principe que vous avez install&eacute; le framework &agrave; la racine de votre repertoire web, il est donc accessible via l&#039;adresse http://localhost/mkframework_v4_XX_XX/<br /><br />Pour information le zip comprend le builder et la librairie du framework<br />Toutes les applications g&eacute;n&eacute;r&eacute;es lient la librairie du builder (qui peut etre copi&eacute;, deplac&eacute;... en n&#039;oubliant pas de parametrer sa nouvelle adresse dans le fichier conf/site.ini.php)<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><h2>Utilisation du builder pour cr&eacute;er une application</h2>Ouvrez votre navigateur &agrave; l&#039;adresse http://localhost/mkframework_v4_XX_XX/<br />Cliquez sur l&#039;onglet &quot;Cr&eacute;er un projet&quot;<br /><img src="data/img/builder_new.png" /><br />Entrez le nom de l&#039;application &agrave; cr&eacute;er, ici : blog<br /><img src="data/img/builder_new_blog.png" /><br />La checkbox &quot;G&eacute;n&eacute;rer avec exemples&quot; permet d&#039;indiquer si le builder doit cr&eacute;er une application vierge, ou un application contenant d&eacute;j&agrave; quelques exemples.<br />Ces modules d&#039;exemples permettent de vous faciliter l&#039;apprentissage.<br />Cliquez sur le bouton &quot;cr&eacute;er&quot;<br />L&#039;application mkbuilder va g&eacute;n&eacute;rer une nouvelle application vierge dans le r&eacute;pertoire Projects/blog<br /><img src="data/img/projet_tree.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="model" name="model"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er la couche mod&egrave;le de votre site</h1><h2>Cr&eacute;ation des tables en base de donn&eacute;e</h2>Pour l&#039;exemple, nous utiliserons une base de donn&eacute;e mysql<br />Commencez par executer ces trois requ&ecirc;tes de cr&eacute;ation de table.<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">article</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">titre</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">resume</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">text&nbsp;NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">auteur_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">auteur</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">prenom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">comment</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">text</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">text&nbsp;NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">article_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Param&eacute;trer la connexion &agrave; la base de donn&eacute;e</h2>Lors de la cr&eacute;ation d&#039;une nouvelle application, le buider cr&eacute;er une arborescence compl&egrave;te comprenant des librairies, des fichiers css, de config...<br />On peut depuis le builder charger le fichier de configuration conf/connexion.ini.php de votre application.<br />Ce fichier permet de g&eacute;rer plusieurs configuration de connexion: aussi bien plusieurs param&egrave;tres de connexion (user,base diff&eacute;rente) que des bases diff&eacute;rentes: mysql/postgresql...<br />Vous pouvez ainsi stocker vos articles sur mysql et vos user sur postgresql...<br />Pour param&eacute;trer vos connexions le plus simplement du monde, editer le fichier conf/connexion.ini.php (situ&eacute; dans Projects/blog)<br /><br />Dans notre exemple, notre base de donn&eacute;e mysql est install&eacute; en local<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">dsn</span><span style="color: #007700">=</span><span style="color: #DD0000">"mysql:dbname=blog;host=127.0.0.1"<br /></span><span style="color: #0000BB">mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">sgbd</span><span style="color: #007700">=</span><span style="color: #0000BB">pdo_mysql<br />mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">hostname</span><span style="color: #007700">=</span><span style="color: #0000BB">127.0.0.1<br />mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">database</span><span style="color: #007700">=</span><span style="color: #0000BB">blog<br />mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">username</span><span style="color: #007700">=</span><span style="color: #0000BB">root<br />mysql</span><span style="color: #007700">.</span><span style="color: #0000BB">password</span><span style="color: #007700">=</span><span style="color: #0000BB">pass<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><br /><br /><h2>G&eacute;n&eacute;rer la couche mod&egrave;le</h2>Le framework &eacute;tant bas&eacute; sur une architecture MVC, il nous faut cr&eacute;er la couche M: Mod&egrave;le qui nous permettra d&#039;interagir avec notre source de donn&eacute;e, ici notre base mysql.<br />Pour cela rien de plus simple, cliquez sur l&#039;onglet &quot;Administrer les projets&quot;, cliquez ensuite sur votre projet, ici &quot;blog&quot;<br /><img src="data/img/builder_blog_index.png" /><br />Cliquez sur &quot;Cr&eacute;er couche model&quot;<br /><img src="data/img/builder_blog_model.png" /><br /><br />Cliquez sur le lien de la configuration &agrave; utiliser, ici &quot;mysql&quot;.<br />Vous verrez s&#039;afficher la liste des tables trouv&eacute;es suivi d&#039;un menu deroulant permettant de designer la cl&eacute; primaire.<br /><img src="data/img/builder_blog_model2.png" /><br />Cliquez sur &quot;generer&quot; pour generer les fichiers de la couche mod&egrave;le.<br /><img src="data/img/builder_blog_model2generated.png" /><br /><br />Voici par exemple la classe model article g&eacute;n&eacute;r&eacute;:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">model_article&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_model</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sClassRow</span><span style="color: #007700">=</span><span style="color: #DD0000">'row_article'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sTable</span><span style="color: #007700">=</span><span style="color: #DD0000">'article'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sConfig</span><span style="color: #007700">=</span><span style="color: #DD0000">'mysql'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$tId</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">_getInstance</span><span style="color: #007700">(</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(</span><span style="color: #0000BB">$uId</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$uId&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">row_article&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_row</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sClassModel</span><span style="color: #007700">=</span><span style="color: #DD0000">'model_article'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;jointure<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;findAuteur(){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;model_auteur::getInstance()-&gt;findById($this-&gt;auteur_id);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;test&nbsp;validation*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTab</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;renseigner&nbsp;vos&nbsp;check&nbsp;ici<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEqual('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEqual('champ','valeurB','Le&nbsp;champ&nbsp;est&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmpty('champ','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEmpty('champ','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmailValid('champ','L\email&nbsp;est&nbsp;invalide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;matchExpression('champ','/[0-9]/','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;au&nbsp;bon&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;notMatchExpression('champ','/[a-zA-Z]/','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;a&nbsp;ce&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oPluginValid</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br /></span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="crud" name="crud"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er un module CRUD (Create Read Update Delete)</h1>Apr&egrave;s avoir cr&eacute;&eacute; votre application, configurer son fichier de connexion et g&eacute;n&eacute;r&eacute; la partie model.<br />Vous pouvez facilement cr&eacute;er un module qui vous permettra de cr&eacute;er des articles, les lister, les &eacute;diter et les supprimer.<br />On appelle aussi &ccedil;a le CRUD : Create Read Update Delete, et la, le builder va vous y aider.<br />Pour cela cliquez sur &quot;Cr&eacute;er un module CRUD&quot;<br /><img src="data/img/builder_blog_crud.png" /><br />Cliquez ensuite sur la classe mod&egrave;le &agrave; utiliser: ici model_article<br /><img src="data/img/builder_blog_crud_article.png" /><br />On voit sur cet &eacute;cran la liste des champs de notre table, avec une checkbox permettant de chosir ceux &agrave; afficher dans notre CRUD.<br />On clique sur le bouton &quot;cr&eacute;er&quot;<br /><img src="data/img/builder_blog_crud_article2.png" /><br />Et voila le crud de votre table article est g&eacute;n&eacute;r&eacute;<br />Au menu:<br />- Create: un lien plus une page contenant un formulaire d&#039;ajout<br />- Read: une page contenant un tableau listant les &eacute;l&eacute;ments de la table<br />- Update: un lien plus une page contenant un formulaire de modification<br />- Delete: un lien plus une page de confirmation de suppression<br /><img src="data/img/projet_tree_article.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="crudandcrudembedded" name="crudandcrudembedded"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er pour 2 tables: deux modules CRUD et int&eacute;grable li&eacute;s</h1><h2>Introduction</h2>Imaginez un cas simple o&ugrave; vous avez deux tables compl&eacute;mentaires, par exemple des auteurs et leurs livres<br />Vous voulez ajouter des auteurs, puis dans chaque auteur lui ajouter une liste de livre<br /><br />Imaginons les tables suivantes:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Auteurs</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">prenom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Livres</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">titre</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">auteur_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /><br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Dans le builder</h2>Apr&egrave;s avoir cr&eacute;&eacute; les tables en base de donn&eacute;es<br /><br />Cr&eacute;ons la couche mod&egrave;le pour les deux tables<br /><img src="data/img/tutoCrudandcrudembedded_model.jpg" /><br /><br />Cr&eacute;ons ensuite d&#039;abord le CRUD de la table des Auteurs<br /><img src="data/img/tutoCrudandcrudembedded_crudAuteur.jpg" /><br /><br />Voyons le module CRUD habituel: Auteurs<br /><img src="data/img/tutoCrudandcrudembedded_modulecrudAuteur.jpg" /><br /><br />Nous allons g&eacute;n&eacute;rer un module int&eacute;grable pour les Livres et l&#039;int&eacute;gr&eacute; par exemple &agrave; la page &quot;show&quot;<br /><br />G&eacute;n&eacute;rons ce module CRUD int&eacute;grable pour Livres<br /><img src="data/img/tutoCrudandcrudembedded_crudintegrableLivres.jpg" /><br />note: notez bien que nous avons d&eacute;coch&eacute; auteur_id, nous le forcerons en fonction de l&#039;auteur selectionn&eacute;<br /><br />Le builder nous demande d&#039;ajouter &agrave; l&#039;endroit souhait&eacute; le code suivant<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//instancier&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">$oModuleLivres</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_Livres</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//si&nbsp;vous&nbsp;souhaitez&nbsp;indiquer&nbsp;au&nbsp;module&nbsp;integrable&nbsp;des&nbsp;informations&nbsp;sur&nbsp;le&nbsp;module&nbsp;parent<br />//$oModuleExamplemodule-&gt;setRootLink('module::action',array('parametre'=&gt;_root::getParam('parametre')));<br /><br />//recupere&nbsp;la&nbsp;vue&nbsp;du&nbsp;module<br /></span><span style="color: #0000BB">$oView</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ouvrons le fichier main.php du module Auteurs module/Auteurs/main.php<br />Et ajoutons ce code dans l&#039;action _show()<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_show</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAuteurs</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Auteurs</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)&nbsp;);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'Auteurs::show'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAuteurs</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAuteurs</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//instancier&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivres</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_Livres</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;vous&nbsp;souhaitez&nbsp;indiquer&nbsp;au&nbsp;module&nbsp;integrable&nbsp;des&nbsp;informations&nbsp;sur&nbsp;le&nbsp;module&nbsp;parent<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setRootLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'Auteurs::show'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recupere&nbsp;la&nbsp;vue&nbsp;du&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Attention: nous avons d&eacute;cid&eacute; d&#039;integrer le module Livres dans la page &quot;show&quot; du module Auteurs, ce qui signifie que le module Livres doit pendre en compte l&#039;id de l&#039;auteur selectionn&eacute; dans ses propres liens<br /><br />En effet on a une url du type: index.php?:nav=Auteurs::show&amp;id=1<br /><br />note: nous avons utilis&eacute; la methode setRootLink qui indique au module int&eacute;grable les parametres du module dans lequel il est int&eacute;gr&eacute;, ici:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setRootLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'Auteurs::show'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)&nbsp;));<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ce qui donne ceci<br /><img src="data/img/tutoCrudandcrudembedded_modulecrudauteursAvecLivres.jpg" /><br /><br />Le probl&egrave;me ici c&#039;est que le module int&eacute;grables des Livres n&#039;a pas conscience d&#039;etre int&eacute;gr&eacute; dans celui des auteurs<br />Nous allons lui communiquer l&#039;info de l&#039;auteur selectionn&eacute;<br /><br />Modifions d&#039;abord la m&eacute;thode _show() du module Auteurs  module/Auteurs/main.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_show</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAuteurs</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Auteurs</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)&nbsp;);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'Auteurs::show'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAuteurs</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAuteurs</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//instancier&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivres</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_Livres</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;vous&nbsp;souhaitez&nbsp;indiquer&nbsp;au&nbsp;module&nbsp;integrable&nbsp;des&nbsp;informations&nbsp;sur&nbsp;le&nbsp;module&nbsp;parent<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setRootLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'Auteurs::show'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;communique&nbsp;au&nbsp;module&nbsp;Livres&nbsp;l'auteur&nbsp;selectionee<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">auteur_id</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAuteurs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recupere&nbsp;la&nbsp;vue&nbsp;du&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Et enfin nous modifions le module int&eacute;grable Livres g&eacute;n&eacute;r&eacute;s pour prendre en compte cette variable auteur_id<br />module/Livres/mains.php<br /><br />Ajout de la propri&eacute;t&eacute; auteur_id en public<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_Livres&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_moduleembedded</span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;</span><span style="color: #0000BB">$sModuleName</span><span style="color: #007700">=</span><span style="color: #DD0000">'Livres'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;</span><span style="color: #0000BB">$sRootModule</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;</span><span style="color: #0000BB">$tRootParams</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//le&nbsp;parametre&nbsp;auteur_id&nbsp;public<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;</span><span style="color: #0000BB">$auteur_id</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />l&#039;action de listage, on ajoute un appel &agrave; une nouvelle m&eacute;thode findListByAuteur avec le parametre auteur_id (on modifiera ensuite la classe mod&egrave;le Auteurs)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLivres</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Livres</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findListByAuteur</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">auteur_id</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'Livres::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tLivres</span><span style="color: #007700">=</span><span style="color: #0000BB">$tLivres</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oView</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />ensuite il faut modifier la m&eacute;thode processSave() pour forcer l&#039;auteur_id au moment de l&#039;enregistrement<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processSave</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;or&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'formmodule'</span><span style="color: #007700">)!=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">$sModuleName&nbsp;</span><span style="color: #007700">){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;array(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$iId</span><span style="color: #007700">=</span><span style="color: #0000BB">module_Livres</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$iId</span><span style="color: #007700">==</span><span style="color: #0000BB">null</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oLivres</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_Livres</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//a&nbsp;l'ajout&nbsp;d'un&nbsp;livre&nbsp;on&nbsp;force&nbsp;l'auteur_id<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oLivres</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">auteur_id</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">auteur_id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oLivres</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Livres</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">module_Livres</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Enfin plus qu&#039;a ajouter la nouvelle m&eacute;thode dans la classe mod&egrave;le model_Livres<br />model/model_Livres.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">model_Livres&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_model</span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findListByAuteur</span><span style="color: #007700">(</span><span style="color: #0000BB">$auteur_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;auteur_id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$auteur_id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><img src="data/img/tutoCrudandcrudembedded_modulecrudAuteursAvecLivres2.jpg" /><br />et<br /><img src="data/img/tutoCrudandcrudembedded_modulecrudAuteursAvecLivres3.jpg" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="menu" name="menu"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter un menu &agrave; votre site</h1><h2>Introduction</h2>Dans votre application vous souhaitez ajouter un ou plusieurs menus.<br />Dans votre module, par exemple article (fichier module/article/main.php)<br />Votre fichier doit ressembler &agrave; peu pr&egrave;s &agrave; cela:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_article&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'template1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_index</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;considere&nbsp;que&nbsp;la&nbsp;page&nbsp;par&nbsp;defaut&nbsp;est&nbsp;la&nbsp;page&nbsp;de&nbsp;listage<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_list</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oArticleModel</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">model_article</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'article::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$tArticle</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListColumn</span><span style="color: #007700">();</span><span style="color: #FF8000">//array('id','titre');//<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />L&#039;id&eacute;e d&#039;ajouter un menu, revient &agrave; ajouter sur notre template un module &agrave; un emplacement particulier.<br /><br />Le module menu (note pour inclure un module, il faut que celui-ci retourne sa vue remplie)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">Class&nbsp;</span><span style="color: #0000BB">module_menu&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_left</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//votre&nbsp;tableau&nbsp;de&nbsp;lien&nbsp;contenant&nbsp;en&nbsp;cle&nbsp;le&nbsp;libelle&nbsp;du&nbsp;menu,&nbsp;et&nbsp;en&nbsp;valeur&nbsp;le&nbsp;couple&nbsp;module/action<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLink</span><span style="color: #007700">=array(<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'Articles'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'article::list'</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'Articles&nbsp;pagine'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'article::listPagination'</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'Prive'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'prive::list'</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;vous&nbsp;utilisez&nbsp;une&nbsp;gestion&nbsp;de&nbsp;droits&nbsp;sur&nbsp;votre&nbsp;site<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">can</span><span style="color: #007700">(</span><span style="color: #DD0000">'edit'</span><span style="color: #007700">,</span><span style="color: #DD0000">'acl'</span><span style="color: #007700">)&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLink</span><span style="color: #007700">[</span><span style="color: #DD0000">'Manage&nbsp;accounts'</span><span style="color: #007700">]=</span><span style="color: #DD0000">'account::list'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLink</span><span style="color: #007700">[</span><span style="color: #DD0000">'Manage&nbsp;groups'</span><span style="color: #007700">]=</span><span style="color: #DD0000">'group::list'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLink</span><span style="color: #007700">[</span><span style="color: #DD0000">'Manage&nbsp;permission'</span><span style="color: #007700">]=</span><span style="color: #DD0000">'permission::list'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'menu::index'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tLink</span><span style="color: #007700">=</span><span style="color: #0000BB">$tLink</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oView</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br /></span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br />Sa vue (fichier module/menu/view/index.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">ul</span><span style="color: #007700">&gt;<br />&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tLink&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sLibelle&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$sLink</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParamNav</span><span style="color: #007700">()==</span><span style="color: #0000BB">$sLink</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&nbsp;class="selectionne"&gt;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #0000BB">$sLink</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sLibelle&nbsp;?&gt;</span>&lt;/a&gt;&lt;/li&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">else:</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #0000BB">$sLink</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$sLibelle&nbsp;?&gt;</span>&lt;/a&gt;&lt;/li&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span><br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endforeach;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/ul&gt;<br /><br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br />Pour cela deux solutions:<br /><h2>Solution 1: utiliser la methode static addModule( emplacement , couple module/action );</h2>Par exemple pour ajouter l&#039;action &quot;left&quot; du module &quot;menu&quot; &agrave; l&#039;emplacement &quot;navigation&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addModule</span><span style="color: #007700">(</span><span style="color: #DD0000">'navigation'</span><span style="color: #007700">,</span><span style="color: #DD0000">'menu::left'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Cette methode est &agrave; ajouter soit dans la methode &quot;before&quot; de votre module pour executer pour tout le module, soit dans la methode concernant une page particuli&egrave;re<br /><h2>Solution 2: le framework g&egrave;rant les vues comme des objets manipulable, on peut instancier le module menu et r&eacute;cup&eacute;rer sa vue &quot;remplie&quot;</h2>Et dans votre module<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oModuleMenu</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_menu</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$oViewMenu</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$oModelMenu</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_left</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'navigation'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oViewMenu</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><a href="#menubootstrap">Ajouter un menu vertical &agrave; votre site [Bootstrap] </a><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="menubootstrap" name="menubootstrap"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter un menu vertical &agrave; votre site [Bootstrap]</h1><h2>Introduction</h2>Dans votre application &quot;compatible Bootstrap&quot; vous souhaitez ajouter un ou plusieurs menus.<br />Modifiez votre layout ainsi:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /><br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">load</span><span style="color: #007700">(</span><span style="color: #DD0000">'menu'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;div&nbsp;class="container&nbsp;theme-showcase"&nbsp;role="main"&gt;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="row"&gt;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="col-sm-3&nbsp;col-sm-offset-1&nbsp;blog-sidebar"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">load</span><span style="color: #007700">(</span><span style="color: #DD0000">'menuLeft'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class="col-sm-8&nbsp;blog-main"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">load</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br />&lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div>Vous noterez que l&#039;on a 2 menu: &quot;menu&quot; et &quot;menuLeft&quot;<br /><br />Dans votre module, par exemple article (fichier module/article/main.php)<br />Votre fichier doit ressembler &agrave; peu pr&egrave;s &agrave; cela:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_article&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'bootstrap'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ajoute&nbsp;ici&nbsp;le&nbsp;chargement&nbsp;du&nbsp;menu&nbsp;de&nbsp;gauche:<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addModule</span><span style="color: #007700">(</span><span style="color: #DD0000">'menuLeft'</span><span style="color: #007700">,</span><span style="color: #DD0000">'menuLeft::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_index</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;considere&nbsp;que&nbsp;la&nbsp;page&nbsp;par&nbsp;defaut&nbsp;est&nbsp;la&nbsp;page&nbsp;de&nbsp;listage<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_list</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oArticleModel</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">model_article</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'article::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$tArticle</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListColumn</span><span style="color: #007700">();</span><span style="color: #FF8000">//array('id','titre');//<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Et le code du menu de gauche &quot;menuLeft&quot;<br />Son fichier module/menuLeft/main.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_menuLeft&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_moduleembedded</span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'menuLeft::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oView</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Et sa vue:<br />Sa vue (fichier module/menuLeft/view/list.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">ul&nbsp;</span><span style="color: #007700">class=</span><span style="color: #DD0000">"nav&nbsp;nav-pills&nbsp;nav-stacked&nbsp;nav-pills-stacked-example"</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">li&nbsp;role</span><span style="color: #007700">=</span><span style="color: #DD0000">"presentation"&nbsp;</span><span style="color: #007700">class=</span><span style="color: #DD0000">"active"</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">a&nbsp;href</span><span style="color: #007700">=</span><span style="color: #DD0000">"#"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Home</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">a</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">li</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">li&nbsp;role</span><span style="color: #007700">=</span><span style="color: #DD0000">"presentation"</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">a&nbsp;href</span><span style="color: #007700">=</span><span style="color: #DD0000">"#"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Profile</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">a</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">li</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">li&nbsp;role</span><span style="color: #007700">=</span><span style="color: #DD0000">"presentation"</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">a&nbsp;href</span><span style="color: #007700">=</span><span style="color: #DD0000">"#"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Messages</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">a</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">li</span><span style="color: #007700">&gt;<br /><br />&lt;/</span><span style="color: #0000BB">ul</span><span style="color: #007700">&gt;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Vous pouvez avoir bien sur 2 menus: un en haut, par exemple g&eacute;n&eacute;r&eacute; via le Builder en plus de ce menu, vous aurez ainsi, une fois le module menu g&eacute;n&eacute;r&eacute; le fichier main.php suivant:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_article&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'bootstrap'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ajoute&nbsp;ici&nbsp;le&nbsp;chargement&nbsp;du&nbsp;menu:<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addModule</span><span style="color: #007700">(</span><span style="color: #DD0000">'menu'</span><span style="color: #007700">,</span><span style="color: #DD0000">'menu::index'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ajoute&nbsp;ici&nbsp;le&nbsp;chargement&nbsp;du&nbsp;menu&nbsp;de&nbsp;gauche:<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addModule</span><span style="color: #007700">(</span><span style="color: #DD0000">'menuLeft'</span><span style="color: #007700">,</span><span style="color: #DD0000">'menuLeft::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_index</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;considere&nbsp;que&nbsp;la&nbsp;page&nbsp;par&nbsp;defaut&nbsp;est&nbsp;la&nbsp;page&nbsp;de&nbsp;listage<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_list</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oArticleModel</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">model_article</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'article::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$tArticle</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticleModel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListColumn</span><span style="color: #007700">();</span><span style="color: #FF8000">//array('id','titre');//<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="auth" name="auth"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter une authentication &agrave; une page/un module</h1>Ajouter une authentification signifie quatre choses:<br />1. cr&eacute;er un model pour g&eacute;rer les comptes de connexions (avec couple login/pass)<br />2. cr&eacute;er ce module qui gerera l&#039;authentification<br />3. indiquer dans le fichier de config ce couple module/action qui gerera l&#039;authentification<br />4. indiquer les pages o&ugrave; l&#039;authentification est n&eacute;cessaire<br /><br /><h2>Etape 1: cr&eacute;er un model pour g&eacute;rer les comptes de connexions (avec couple login/pass)</h2>Commencons par creer un model &quot;compte de connexion&quot;, ici &quot;account&quot;<br />Pour l&#039;exemple on stoquera les comptes de connexion dans une base mysql<br />Seront n&eacute;c&eacute;ssaire les champs login et mots de passe.<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">model_account&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_model</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sClassRow</span><span style="color: #007700">=</span><span style="color: #DD0000">'row_account'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sTable</span><span style="color: #007700">=</span><span style="color: #DD0000">'account'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sConfig</span><span style="color: #007700">=</span><span style="color: #DD0000">'mysql'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$tId</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">_getInstance</span><span style="color: #007700">(</span><span style="color: #0000BB">__CLASS__</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(</span><span style="color: #0000BB">$uId</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$uId&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">=array();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tAccount&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">login</span><span style="color: #007700">][</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">pass</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">sha1</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">row_account&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_row</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sClassModel</span><span style="color: #007700">=</span><span style="color: #DD0000">'model_account'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;jointure<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;findAuteur(){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;model_auteur::getInstance()-&gt;findById($this-&gt;auteur_id);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;test&nbsp;validation*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTab</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;renseigner&nbsp;vos&nbsp;check&nbsp;ici<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEqual('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEqual('champ','valeurB','Le&nbsp;champ&nbsp;est&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmpty('champ','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEmpty('champ','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmailValid('champ','L\email&nbsp;est&nbsp;invalide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;matchExpression('champ','/[0-9]/','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;au&nbsp;bon&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;notMatchExpression('champ','/[a-zA-Z]/','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;a&nbsp;ce&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oPluginValid</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br /></span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><h2>Etape 2: cr&eacute;er ce module qui gerera l&#039;authentification</h2>Appelons-le par exemple &quot;auth&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_auth&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;active&nbsp;l'authentification<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">enable</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'template1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_login</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::login'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sLogin</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'login'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;stoque&nbsp;les&nbsp;mots&nbsp;de&nbsp;passe&nbsp;hash&nbsp;en&nbsp;sha1&nbsp;pour&nbsp;l'exemple<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sPass</span><span style="color: #007700">=</span><span style="color: #0000BB">model_account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">model_account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;va&nbsp;verifier&nbsp;que&nbsp;l'on&nbsp;trouve&nbsp;dans&nbsp;le&nbsp;tableau&nbsp;retourn&nbsp;par&nbsp;notre&nbsp;model&nbsp;"account"<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//l'entre&nbsp;$tAccount[&nbsp;login&nbsp;][&nbsp;mot&nbsp;de&nbsp;passe&nbsp;hash*&nbsp;]<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">checkLoginPass</span><span style="color: #007700">(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">,</span><span style="color: #0000BB">$sLogin</span><span style="color: #007700">,</span><span style="color: #0000BB">$sPass</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'prive::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_logout</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">logout</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">after</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">show</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>* Pour des raisons de s&eacute;curit&eacute;, on ne stoque jamais un mot de passe en clair, on stoque son hash, et lors de l&#039;authentification, on hash de la m&ecirc;me mani&egrave;re le mot de passe envoy&eacute; pour verifi&eacute; si les deux hash sont identiques.<br /><br /><h2>Etape 3: indiquer dans le fichier de config ce couple module/action qui gerera l&#039;authentification</h2>Dans le fichier conf/site.ini.php de votre site<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">[</span><span style="color: #0000BB">auth</span><span style="color: #007700">]<br />;</span><span style="color: #0000BB">note&nbsp;</span><span style="color: #007700">:&nbsp;&gt;=&nbsp;</span><span style="color: #0000BB">php5.2&nbsp;dans&nbsp;le&nbsp;php</span><span style="color: #007700">.</span><span style="color: #0000BB">ini<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">cookie_httponly</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">use_cookies&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">use_only_cookies&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">cookie_secure</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />enabled</span><span style="color: #007700">=</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">class=</span><span style="color: #0000BB">plugin_auth<br />module</span><span style="color: #007700">=</span><span style="color: #0000BB">auth</span><span style="color: #007700">::</span><span style="color: #0000BB">login<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">timeout</span><span style="color: #007700">.</span><span style="color: #0000BB">enabled</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />session</span><span style="color: #007700">.</span><span style="color: #0000BB">timeout</span><span style="color: #007700">.</span><span style="color: #0000BB">lifetime</span><span style="color: #007700">=</span><span style="color: #0000BB">180<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div>Ici il est important de configurer la ligne module<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />module</span><span style="color: #007700">=</span><span style="color: #0000BB">auth</span><span style="color: #007700">::</span><span style="color: #0000BB">login<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><br />note: tout le module &quot;auth&quot; sera accessible<br /><br /><h2>Etape 4: indiquer les pages o&ugrave; l&#039;authentification est n&eacute;cessaire</h2>Il suffit d&#039;ajouter dans chaque methode &quot;before&quot; de module &agrave; restreindre<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">enable</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Donc soit vous indiquer que tout un module est restreint en mettant cette appel dans before<br />Soit vous copier cette ligne dans la methode before d&#039;une page particuli&egrave;re<br />Par exemple pour restreindre la page article::edit<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//methode&nbsp;appele&nbsp;avant&nbsp;la&nbsp;page&nbsp;"edit"<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before_edit</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">enable</span><span style="color: #007700">();<br />}<br />public&nbsp;function&nbsp;</span><span style="color: #0000BB">_edit</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//votre&nbsp;page&nbsp;"edit"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="auth2" name="auth2"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter une authentication via le builder</h1>Le builder permet de vous aider &agrave; cr&eacute;er une authentification pour votre site<br /><img src="data/img/builder_auth.png" /><br />Cliquer sur le menu &quot;Cr&eacute;er un module d&#039;authentification&quot;<br /><img src="data/img/builder_auth2.png" /><br />Ici un message vous averti que le builder ne trouve pas de classe mod&egrave;le utilisable.<br />Il faut en effet une table de gestion de comptes de connexion ainsi qu&#039;une classe mod&egrave;le la liant, mais ce n&#039;est pas tout, comme vous pouvez le lire, il faut lui ajouter ces deux m&eacute;thodes.<br />L&#039;une pour retourner un tableau index&eacute;, l&#039;autre pour hacher un mot de passe (les mots de passe ne se stoque pas en clair)<br />Cr&eacute;ons une table &quot;comptes&quot; avec 3 champs &quot;id&quot;, &quot;utilisateur&quot; et &quot;motdepasse&quot;<br /><img src="data/img/builder_auth3.png" /><br />G&eacute;n&eacute;rons la classe mod&egrave;le<br /><img src="data/img/builder_auth4.png" /><br />Il ne vous reste plus qu&#039;&agrave; copier les deux m&eacute;thodes<br />Pensez bien pour la m&eacute;thode &agrave; indiquer le bon champ pour le nom d&#039;utilisateur et le mot de passe.<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">=array();<br /><br />if(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">){<br />foreach(</span><span style="color: #0000BB">$tAccount&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;cree&nbsp;ici&nbsp;un&nbsp;tableau&nbsp;indexe&nbsp;par&nbsp;nom&nbsp;d'utilisateur&nbsp;et&nbsp;mot&nbsp;de&nbsp;pase<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">login</span><span style="color: #007700">][</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">pass</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">;<br />}<br />}<br /><br />return&nbsp;</span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">;<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ici il faut indiquer comme login &quot;utilisateur&quot; et pass &quot;motdepasse&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">=array();<br /><br />if(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">){<br />foreach(</span><span style="color: #0000BB">$tAccount&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;cree&nbsp;ici&nbsp;un&nbsp;tableau&nbsp;indexe&nbsp;par&nbsp;nom&nbsp;d'utilisateur&nbsp;et&nbsp;mot&nbsp;de&nbsp;pase<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">utilisateur</span><span style="color: #007700">][</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">motdepasse</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">;<br />}<br />}<br /><br />return&nbsp;</span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">;<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><img src="data/img/builder_auth5.png" /><br />D&eacute;sormais si vous retournez sur le menu &quot;Cr&eacute;er un module d&#039;authentification&quot;<br />Vous avez un menu d&eacute;roulant listant votre classe mod&egrave;le &quot;comptes&quot;<br />Un champ texte pour indiquer le nom du module d&#039;authentification<br />Et enfin le couple module/action &agrave; rediriger apr&egrave;s authentification.<br /><img src="data/img/builder_auth6.png" /><br />En cliquant sur le bouton &quot;G&eacute;n&eacute;rer le module d&#039;authentification&quot;, le builder cr&eacute;&eacute; un module &quot;auth&quot; et vous invite &agrave; passer la variable d&#039;authentification &agrave; 1<br />Il y a m&ecirc;me un lien pour vous permettre d&#039;&eacute;diter le fichier de configuration<br /><img src="data/img/builder_auth7.png" /><br />En suivant ce lien vous acc&eacute;dez via l&#039;explorateur du projet au fichier de configuration conf/site.ini.php<br /><img src="data/img/builder_auth8.png" /><br />D&eacute;sormais si vous acc&eacute;dez &agrave; votre site, vous devez vous identifier.<br /><img src="data/img/builder_auth9.png" /><br /><br />Note: si vous souhaitez cr&eacute;er un utilisateur, vous pouvez creer une methode &agrave; cet effet dans le module &quot;auth&quot; (fichier module/auth/main.php)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_add</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_comptes</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">utilisateur</span><span style="color: #007700">=</span><span style="color: #DD0000">'login'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">motdepasse</span><span style="color: #007700">=</span><span style="color: #0000BB">model_comptes</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">print&nbsp;</span><span style="color: #DD0000">"Utilisateur&nbsp;cr&amp;eacute;&amp;eacute;"</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et rendez-vous &agrave; l&#039;adresse index.php?:nav=auth::add<br />Une fois fait, vous pouvez vous loguer avec &quot;login&quot; comme nom d&#039;utilisateur et &quot;pass&quot; comme mot de passe<br /><br />note: pensez a bien renseigner le champ d&#039;utilisateur et de mot de passe en fonction de votre base de donn&eacute;e.<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="auth2b" name="auth2b"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Enrichir le module d&#039;authentification</h1>Ce tutorial se base sur le fait que vous ayez g&eacute;n&eacute;r&eacute; un module d&#039;authentification &agrave; l&#039;aide du Builder (par exemple via <a href="tutoriaux.html#auth2">ce tutoriel </a><br /><h2>Cot&eacute; model</h2>Ajoutez un champ de type entier &quot;nbFail&quot;, il contiendra le nombre de tentative infructueuse<br />On l&#039;incrementera &agrave; chaque erreur de mot de passe, et on bloquera le compte si ce nombre est sup&eacute;rieur &agrave; 3<br /><h2>Modification du module</h2>Il suffit de modifier la m&eacute;thode verifiant le mot de passe pour ajouter<br />1. d&#039;incrementer le champ &quot;nbFail&quot; pour determiner un seuil de blocage<br />2. de verifier ce nombre d&#039;erreur pour savoir si le compte est bloquee<br />3. de remettre a zero ce compteur quand le mot de passe correct est renseigne (si le seuil n&#039;est pas atteint)<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">checkLoginPass</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;le&nbsp;formulaire&nbsp;n'est&nbsp;pas&nbsp;envoye&nbsp;on&nbsp;s'arrete&nbsp;la<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sLogin</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'login'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sPassword</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">maxPasswordLength</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Mot&nbsp;de&nbsp;passe&nbsp;trop&nbsp;long'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;stoque&nbsp;les&nbsp;mots&nbsp;de&nbsp;passe&nbsp;hashe&nbsp;dans&nbsp;la&nbsp;classe&nbsp;model_auteur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sHashPassword</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//AJOUT:&nbsp;verification&nbsp;si&nbsp;le&nbsp;compte&nbsp;est&nbsp;bloque<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(isset(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$sLogin</span><span style="color: #007700">])&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">list(</span><span style="color: #0000BB">$sAccountHashPassword</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$oAccountFound</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">each</span><span style="color: #007700">(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$sLogin</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nbFail&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Compte&nbsp;bloquee'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">checkLoginPass</span><span style="color: #007700">(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">,</span><span style="color: #0000BB">$sLogin</span><span style="color: #007700">,</span><span style="color: #0000BB">$sHashPassword</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//AJOUT:&nbsp;on&nbsp;incremente&nbsp;le&nbsp;nombre&nbsp;d'erreur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nbFail</span><span style="color: #007700">=(int)</span><span style="color: #0000BB">$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nbFail</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Mauvais&nbsp;login/mot&nbsp;de&nbsp;passe'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//AJOUT:&nbsp;on&nbsp;peut&nbsp;annuler&nbsp;le&nbsp;nombre&nbsp;de&nbsp;tentatives&nbsp;manquees<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//quand&nbsp;elles&nbsp;sont&nbsp;superieur&nbsp;a&nbsp;0&nbsp;si&nbsp;l'utilisateur&nbsp;entre&nbsp;ses&nbsp;bons&nbsp;identifiants<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nbFail&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nbFail</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccountFound</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'default::index'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />note: il faut prevoir d&#039;intervenir en base de donn&eacute;e pour remettre nbFail &agrave; zero pour debloquer le compte manuellement<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="upload" name="upload"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Permettre l&#039;upload d&#039;un fichier</h1><h2>Introduction</h2>Vous pouvez avoir besoin sur un site web par exemple de permettre &agrave; vos utilisateurs d&#039;uploader leur photo de profil.<br />Voici comment g&eacute;rer un upload.<br />Dans notre exemple, nous partons de l&#039;existence d&#039;une table &quot;account&quot; (dont la cl&eacute; primaire est &quot;id&quot;) contenant un champ &quot;profilPicture&quot; et d&#039;un module s&#039;appellant &quot;profil&quot;.<br /><br /><h2>Cot&eacute; vue</h2>Ecrivez votre formulaire, en prenant bien soin de pr&eacute;ciser l&#039;attribut &quot;enctype&quot; dans votre balise &quot;form&quot;.<br />Editer le fichier module/profil/view/uploadProfilPicture.pho<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"&nbsp;</span><span style="color: #0000BB">enctype</span><span style="color: #007700">=</span><span style="color: #DD0000">"multipart/form-data"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">Photo&nbsp;de&nbsp;profil&nbsp;</span><span style="color: #007700">:&nbsp;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"file"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"profilPicture"&nbsp;</span><span style="color: #007700">/&gt;<br /><br />&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profilPicture</span><span style="color: #007700">!=</span><span style="color: #DD0000">''</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&lt;img&nbsp;src="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profilPicture&nbsp;?&gt;</span>"&nbsp;/&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;input&nbsp;type="submit"&nbsp;value="Sauvegarder"/&gt;<br /><br />&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><h2>Cot&eacute; controlleur</h2>Dans l&#039;action de cette page d&#039;upload, nous allons<br />d&#039;une part fare appel &agrave; la vue pr&eacute;cedemment cr&eacute;&eacute;e<br />et d&#039;autre part g&eacute;rer la reception, l&#039;upload puis l&#039;enregistrement du chemin de l&#039;image dans le champ &quot;profilPicture&quot;<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_private&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recuperation&nbsp;de&nbsp;l'id&nbsp;du&nbsp;compte&nbsp;de&nbsp;l'utilisateur&nbsp;connect<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getAccount</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_uploadProfilPicture</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkUpload</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'profil::uploadProfilPicture'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;</span><span style="color: #0000BB">checkUpload</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sColumn</span><span style="color: #007700">=</span><span style="color: #DD0000">'profilPicture'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginUpload</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_upload</span><span style="color: #007700">(</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oPluginUpload</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sNewFileName</span><span style="color: #007700">=</span><span style="color: #DD0000">'data/upload/'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">.</span><span style="color: #DD0000">'_'</span><span style="color: #007700">.</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'Ymdhis'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginUpload</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">saveAs</span><span style="color: #007700">(</span><span style="color: #0000BB">$sNewFileName</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profilPicture</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginUpload</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getPath</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="crudembedded" name="crudembedded"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er un module CRUD int&eacute;grable (Create Read Update Delete)</h1>Cette partie permet de g&eacute;n&eacute;rer un module que vous pourrez int&eacute;grer dans un autre module.<br />Pour cela cliquez sur &quot;Cr&eacute;er un module CRUD int&eacute;grable&quot;<br /><img src="data/img/builder_blog_crudembedded.png" /><br />Cliquez ensuite sur la classe mod&egrave;le &agrave; utiliser: ici model_article<br /><img src="data/img/builder_blog_crudembedded_article.png" /><br />On voit sur cet &eacute;cran la liste des champs de notre table, avec une checkbox permettant de chosir ceux &agrave; afficher dans notre CRUD.<br />On clique sur le bouton &quot;cr&eacute;er&quot;<br /><img src="data/img/builder_blog_crudembedded_article2.png" /><br />Et voila le module crud int&eacute;grable de votre table article est g&eacute;n&eacute;r&eacute;<br />Au menu:<br />- Create: un lien plus une page contenant un formulaire d&#039;ajout<br />- Read: une page contenant un tableau listant les &eacute;l&eacute;ments de la table<br />- Update: un lien plus une page contenant un formulaire de modification<br />- Delete: un lien plus une page de confirmation de suppression<br /><img src="data/img/projet_tree_article.png" /><br />Il vous suffit de copier dans le fichier main.php de votre module principal les lignes suivantes<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;ce&nbsp;module&nbsp;integrable<br /></span><span style="color: #0000BB">$oModuleArticle</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_article</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//on&nbsp;recuere&nbsp;la&nbsp;vue&nbsp;de&nbsp;ce&nbsp;module<br /></span><span style="color: #0000BB">$oViewArticle</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleArticle</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;cette&nbsp;vue&nbsp;a&nbsp;notre&nbsp;layout<br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oViewArticle</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />note: dans le cas de &quot;poup&eacute;es russes&quot; de modules, il vous faut assigner la vue retourn&eacute;e au module, qui devra l&#039;afficher<br />Ainsi pour un module A incluant un module B (int&eacute;grable) qui incluerait lui-m&ecirc;me un module C (int&eacute;grable)<br />Au niveau du module B<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oViewB</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'monModuleB::notreVueB'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;le&nbsp;module&nbsp;integrable&nbsp;C<br /></span><span style="color: #0000BB">$oModuleC</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_monModuleC</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//on&nbsp;recuere&nbsp;la&nbsp;vue&nbsp;de&nbsp;ce&nbsp;module&nbsp;C<br /></span><span style="color: #0000BB">$oViewModuleC</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleC</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;la&nbsp;vue&nbsp;C&nbsp;&nbsp;la&nbsp;vue&nbsp;B&nbsp;;)<br /></span><span style="color: #0000BB">$oViewB</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oViewModuleC</span><span style="color: #007700">=</span><span style="color: #0000BB">$oViewModuleC</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />qu&#039;on affichera dans la vue B ;)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oViewModuleC</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">show</span><span style="color: #007700">()</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="formulaire" name="formulaire"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>V&eacute;rifier les entr&eacute;es d&#039;un formulaire</h1><h2>Introduction</h2>La v&eacute;rification des entr&eacute;es de formulaire se passe cot&eacute; &quot;model&quot; elle passe par un retour d&#039;un tableau des erreurs trouv&eacute;es qui seront affich&eacute;es par la suite dans la vue.<br />Nous allons dans notre exemple ajouter des contr&ocirc;le sur une table client<br /><h2>Cot&eacute; model</h2>Cot&eacute; model, &eacute;diter votre classe row_client<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">row_client&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_row</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">protected&nbsp;</span><span style="color: #0000BB">$sClassModel</span><span style="color: #007700">=</span><span style="color: #DD0000">'model_client'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;jointure<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;findAuteur(){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;model_auteur::getInstance()-&gt;findById($this-&gt;auteur_id);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*exemple&nbsp;test&nbsp;validation*/<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTab</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;renseigner&nbsp;vos&nbsp;check&nbsp;ici<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEqual('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEqual('champ','valeurB','Le&nbsp;champ&nbsp;est&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isUpperOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;sup&amp;eacute;&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isLowerOrEqualThan('champ','valeurB','Le&nbsp;champ&nbsp;n\est&nbsp;pas&nbsp;inf&amp;eacute;rieur&nbsp;ou&nbsp;&amp;eacute;gal&nbsp;&amp;agrave;&nbsp;'.$valeurB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmpty('champ','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isNotEmpty('champ','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;vide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;isEmailValid('champ','L\email&nbsp;est&nbsp;invalide');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;matchExpression('champ','/[0-9]/','Le&nbsp;champ&nbsp;n\'est&nbsp;pas&nbsp;au&nbsp;bon&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginValid-&gt;notMatchExpression('champ','/[a-zA-Z]/','Le&nbsp;champ&nbsp;ne&nbsp;doit&nbsp;pas&nbsp;&amp;ecirc;tre&nbsp;a&nbsp;ce&nbsp;format');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oPluginValid</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Par d&eacute;fault, chaque classe &quot;model&quot; g&eacute;n&eacute;r&eacute; inclus ceci, vous devez ajouter les v&eacute;rifications au sein de la m&eacute;thode &quot;getCheck&quot;<br />Dans notre exemple, nous allons v&eacute;rifier que les noms et prenoms sont bien rempli et que l&#039;email est correct<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTab</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isNotEmpty</span><span style="color: #007700">(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Ce&nbsp;champ&nbsp;doit&nbsp;&amp;ecirc;tre&nbsp;saisi'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isNotEmpty</span><span style="color: #007700">(</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Ce&nbsp;champ&nbsp;doit&nbsp;&amp;ecirc;tre&nbsp;saisi'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isNotEmpty</span><span style="color: #007700">(</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Ce&nbsp;champ&nbsp;doit&nbsp;&amp;ecirc;tre&nbsp;saisi'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isEmailValid</span><span style="color: #007700">(</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Cet&nbsp;email&nbsp;est&nbsp;invalide'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oPluginValid</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Toutes les methodes de verifications sont pr&eacute;sentes au sein de la classe plugin_check.php, n&#039;hesitez pas &agrave; en ajouter si il vous en manque ;)<br /><h2>Cot&eacute; controleur</h2>Lorsque vous soumettez un formulaire, vous pouvez verifier l&#039;arriv&eacute;e d&#039;une requ&ecirc;te &quot;post&quot; et choisir de la traiter<br />C&#039;est &agrave; ce moment la que l&#039;on va cr&eacute;er notre futur enregistrement &quot;client&quot;, l&#039;enrichir des informations fournies via le formulaire, pour enfin demander si cet enregistrement est valide avant de l&#039;enregistrer.<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_new</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'client::new'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$tMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br />}<br /><br />public&nbsp;function&nbsp;</span><span style="color: #0000BB">save</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oClient</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_client</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$tFields</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'email'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tFields&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sField</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oClient</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$sField</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #0000BB">$sField</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oClient</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oClient</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//une&nbsp;fois&nbsp;enregistre&nbsp;on&nbsp;redirige&nbsp;(vers&nbsp;la&nbsp;page&nbsp;d'edition)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'client::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oClient</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Comme vous le voyez ici j&#039;ai scind&eacute; la partie enregistrement et la partie action, dans cette partie enregistrement, on v&eacute;rifie d&#039;abord que la requ&ecirc;te est bien &quot;post&quot;, puis on boucle sur les champs attendus.<br />Enfin on verifie que l&#039;enregistrement est &quot;valide&quot; (que les checks sont concluant), si ce n&#039;est pas le cas, on retourne &agrave; l&#039;action le tableau des messages d&#039;erreurs.<br />Ce tableau d&#039;erreur nous allons l&#039;assigner &agrave; notre vue pour indiquer &agrave; l&#039;utilisateur les champs en erreur.<br /><h2>Cot&eacute; vue</h2>Dans votre vue view/new.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br />&lt;</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Nom</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"text"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"nom"</span><span style="color: #007700">/&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Pr&amp;eacute;nom&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="text"&nbsp;name="prenom"/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Email&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="text"&nbsp;name="prenom"/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;p&gt;&lt;input&nbsp;type="submit"&nbsp;value="Ajouter"&nbsp;/&gt;&lt;/p&gt;<br />&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div>Ici, sous chacun des champs, on verifie si il y a des messages sur un des champs de saisie.<br />note: attention: ce qui est retourn&eacute;e c&#039;est un &quot;tag&quot; et non un message &quot;ecrit&quot;, ca permet de choisir le message &agrave; afficher<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="ajoutcheck" name="ajoutcheck"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter une verification particuli&egrave;re</h1><h2>Introduction</h2>Lorsque vous utilisez la verification cot&eacute; model, vous instanciez un objet issu de la classe plugin_valid, puis indiquez un ensemble de verification &agrave; faire.<br />Ce qui se passe c&#039;est une utilisation des methodes de la classe plugin_check.<br />Si vous souhaitez ajouter une verification particuli&egrave;re: par exemple verifier qu&#039;un volume est divisible par 25 pour nos commandes.<br /><h2>Ajouter une methode de verification dans la classe plugin_check</h2>Editez votre plugin plugin_check<br />Et ajoutez la methode suivante:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">/**<br />*&nbsp;verifie&nbsp;si&nbsp;le&nbsp;$uValue&nbsp;est&nbsp;divisible&nbsp;par&nbsp;25<br />*&nbsp;@access&nbsp;public<br />*&nbsp;@param&nbsp;undefined&nbsp;$uValue&nbsp;valeur<br />*&nbsp;@return&nbsp;bool&nbsp;retourne&nbsp;true/false&nbsp;selon<br />*/<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">isDivisibleBy25</span><span style="color: #007700">(</span><span style="color: #0000BB">$uValue</span><span style="color: #007700">,</span><span style="color: #0000BB">$sErrorMsg</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(&nbsp;</span><span style="color: #0000BB">$uValue&nbsp;</span><span style="color: #007700">%&nbsp;</span><span style="color: #0000BB">25&nbsp;</span><span style="color: #007700">==</span><span style="color: #0000BB">0</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sErrorMsg</span><span style="color: #007700">=</span><span style="color: #0000BB">$sErrorMsg</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><h2>Utilisez cette methode personnelle lors de la verification</h2>Editez votre fichier model par exemple model_commande.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">getCheck</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getTab</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginValid</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isDivisibleBy</span><span style="color: #007700">(</span><span style="color: #DD0000">'volume'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Ce&nbsp;volume&nbsp;n\'est&nbsp;pas&nbsp;divisible&nbsp;par&nbsp;25'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oPluginValid</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="ajoutcheck2" name="ajoutcheck2"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter une verification ponctuelle</h1><h2>Introduction</h2>Vous pouvez ajouter ponctuellement une verification dans un formulaire en utilisant la m&eacute;thode ko du plugin check<br />Par exemple en d&eacute;but de traitement de formulaire:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">processSave</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;array(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//et&nbsp;ici&nbsp;avant&nbsp;le&nbsp;traitement&nbsp;du&nbsp;formulaire&nbsp;on&nbsp;peut&nbsp;ajouter&nbsp;des&nbsp;verifications<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCheck</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_valid</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getParamsPOST</span><span style="color: #007700">());<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(&nbsp;</span><span style="color: #0000BB">maCondition&nbsp;</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCheck</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ko</span><span style="color: #007700">(</span><span style="color: #DD0000">'mon&nbsp;texte&nbsp;d&nbsp;erreur'</span><span style="color: #007700">,</span><span style="color: #DD0000">'le&nbsp;champ&nbsp;du&nbsp;formulaire'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oCheck</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oCheck</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="formulaireplugin" name="formulaireplugin"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Facilitez la cr&eacute;ation de formulaire</h1><h2>Introduction</h2>Pour vous simplifier l&#039;ecriture de vos fomulaires, vous pouvez utiliser le plugin_html<br /><h2>Creer un menu deroulant</h2>Pour creer un menu deroulant par exemple de pays<br />Vous pouvez utiliser la methode getSelect du plugin_html<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oPluginHtml</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_html</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">=array(</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #DD0000">'Janvier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Fevrier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mars'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Avril'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mai'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juin'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juillet'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Aout'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Septembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Octobre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Novembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Decembre'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$oPluginHtml</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'pays'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ce qui donnera<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">select&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"pays"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"0"</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"1"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Janvier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"2"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Fevrier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"3"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mars</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"4"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Avril</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"5"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mai</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"6"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juin</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"7"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juillet</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"8"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Aout</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"9"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Septembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"10"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Octobre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"11"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Novembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"12"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Decembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br />&lt;/</span><span style="color: #0000BB">select</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Pour preselectionner une valeur, utiliser le 3 eme parametre<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oPluginHtml</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_html</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">=array(</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #DD0000">'Janvier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Fevrier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mars'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Avril'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mai'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juin'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juillet'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Aout'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Septembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Octobre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Novembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Decembre'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$oPluginHtml</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'pays'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ce qui donnera<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">select&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"pays"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"0"</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"1"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Janvier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"2"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Fevrier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;select</span><span style="color: #007700">=</span><span style="color: #DD0000">"select"&nbsp;</span><span style="color: #0000BB">value</span><span style="color: #007700">=</span><span style="color: #DD0000">"3"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mars</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"4"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Avril</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"5"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mai</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"6"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juin</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"7"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juillet</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"8"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Aout</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"9"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Septembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"10"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Octobre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"11"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Novembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"12"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Decembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br />&lt;/</span><span style="color: #0000BB">select</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Pour ajouter une action onchange par exemple<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$oPluginHtml</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_html</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">=array(</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #DD0000">'Janvier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Fevrier'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mars'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Avril'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Mai'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juin'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Juillet'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Aout'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Septembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Octobre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Novembre'</span><span style="color: #007700">,</span><span style="color: #DD0000">'Decembre'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$oPluginHtml</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'pays'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tMonth</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'onChange'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'goTo(this.value)'</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ce qui donnera<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">select&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"pays"&nbsp;</span><span style="color: #0000BB">onChange</span><span style="color: #007700">=</span><span style="color: #DD0000">"goTo(this.value)"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"0"</span><span style="color: #007700">&gt;&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"1"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Janvier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"2"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Fevrier</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;select</span><span style="color: #007700">=</span><span style="color: #DD0000">"select"&nbsp;</span><span style="color: #0000BB">value</span><span style="color: #007700">=</span><span style="color: #DD0000">"3"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mars</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"4"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Avril</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"5"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mai</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"6"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juin</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"7"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Juillet</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"8"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Aout</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"9"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Septembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"10"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Octobre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"11"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Novembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">option&nbsp;value</span><span style="color: #007700">=</span><span style="color: #DD0000">"12"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Decembre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">option</span><span style="color: #007700">&gt;<br />&lt;/</span><span style="color: #0000BB">select</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Plus d&#039;infos ici : <a href="http://mkdevs.com/doxygen/classplugin__html.html">http://mkdevs.com/doxygen/classplugin__html.html </a><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="acl" name="acl"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>G&eacute;rer des permissions (ACL)</h1><h2>Introduction</h2>Si vous avez besoin de g&eacute;rer des droits/permissions sur votre application<br /><h2>Base de donn&eacute;es</h2>Il vous faut au minimum 3 tables : Account, Groupe et Permission<br />Par exemple, ici en se basant sur une base mysql<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Account</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">login</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">pass</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">groupe_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Groupe</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">name</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Permission</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">action</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">element</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">allowdeny</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">groupe_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">),<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Un utilisateur appartient &agrave; un groupe, ce groupe poss&egrave;de des permissions de faire certaines actions sur certains &eacute;l&eacute;ments.<br />Passez par le builder pour g&eacute;n&eacute;rer les classes mod&egrave;les de ces tables.<br />model_Account.php<br />model_Groupe.php (cochez cr&eacute;er une methode getSelect() avec id comme cl&eacute; et name comme valeur)<br />et<br />model_Permission.php<br /><br />Puis ajouter dans la classe model_Permission une methode findByGroup pour r&eacute;cup&eacute;rer les permissions de groupe de l&#039;utilisateur<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findByGroup</span><span style="color: #007700">(</span><span style="color: #0000BB">$group</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;groupe_id=?'</span><span style="color: #007700">,(int)</span><span style="color: #0000BB">$group</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ajoutez dans la classe model_account une methode getListAccount qui permettra de v&eacute;rifier les identifiants &agrave; la connexion.<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">=array();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tAccount&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tLoginPassAccount</span><span style="color: #007700">[</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">login</span><span style="color: #007700">][</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">pass</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$tLoginPassAccount</span><span style="color: #007700">;<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ajoutez enfin une m&eacute;thode pour v&eacute;rifier qu&#039;un compte est unique (n&eacute;cessaire &agrave; l&#039;inscription)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">isUnique</span><span style="color: #007700">(</span><span style="color: #0000BB">$login</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;login=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$login</span><span style="color: #007700">)&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Cr&eacute;er des groupes</h2>En base de donn&eacute;e entrez des groupes dans la base de donn&eacute;e, par exemple &quot;1&quot; pour &quot;read&quot;, et &quot;2&quot; pour &quot;read-write&quot;<br /><br /><h2>Param&eacute;trez les permissions</h2>Pensez &agrave; ajouter en base votre param&eacute;trage de permissions: vous pouvez dans un premier temps g&eacute;n&eacute;rer un module CRUD sur votre table permission pour faciliter celui-ci.<br />Pensez &agrave; la g&eacute;n&eacute;ration du module CRUD de s&eacute;lectionnez pour le champ groupe_id &quot;model_Groupe::getSelect()&quot;<br /><br /><h2>Module authentification</h2>Cr&eacute;er via le builder un module &quot;auth&quot; avec trois actions: login,logout et inscription<br />Le builder va cr&eacute;er<br />- un r&eacute;pertoire module/auth,<br />- un fichier module/auth/main.php ,<br />- un sous r&eacute;pertoire module/auth/view<br />- ainsi que 3 fichiers de vue module/auth/view/login.php, logout.php et inscription.php<br /><br /><h3>Page de login</h3>Renseignez le fichier auth/login.php ainsi:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;Nom&nbsp;d</span><span style="color: #DD0000">'utilisateur&nbsp;&lt;input&nbsp;type="text"&nbsp;name="login"&nbsp;/&gt;&lt;br/&gt;<br />&nbsp;&nbsp;&nbsp;Mot&nbsp;de&nbsp;passe&nbsp;&lt;input&nbsp;type="password"&nbsp;name="password"&nbsp;/&gt;&lt;br&nbsp;/&gt;<br />&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="submit"&nbsp;value="Se&nbsp;connecter"&nbsp;/&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;?php&nbsp;echo&nbsp;$this-&gt;message?&gt;&lt;/p&gt;<br />&lt;/form&gt;<br /><br />&lt;p&gt;&lt;a&nbsp;href="&lt;?php&nbsp;echo&nbsp;_root::getLink('</span><span style="color: #0000BB">auth</span><span style="color: #007700">::</span><span style="color: #0000BB">inscription</span><span style="color: #DD0000">')?&gt;"&gt;Inscription&lt;/a&gt;&lt;/p&gt;<br /><br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><h3>Page d&#039;inscription</h3>Renseignez le fichier auth/inscription.php ainsi:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">h1</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Inscription</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">h1</span><span style="color: #007700">&gt;<br />&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Nom&nbsp;d</span><span style="color: #DD0000">'utilisateur&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type="text"&nbsp;name="login"&nbsp;value="&lt;?php&nbsp;echo&nbsp;_root::getParam('</span><span style="color: #0000BB">login</span><span style="color: #DD0000">')?&gt;"&nbsp;/&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Mot&nbsp;de&nbsp;passe&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type="password"&nbsp;name="password"&nbsp;/&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Confirmez&nbsp;le&nbsp;mot&nbsp;de&nbsp;passe&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type="password"&nbsp;name="password2"&nbsp;/&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type="submit"&nbsp;value="S'</span><span style="color: #0000BB">enregistrer</span><span style="color: #DD0000">"&nbsp;/&gt;<br /><br />&lt;p&gt;&lt;?php&nbsp;echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">message</span><span style="color: #DD0000">?&gt;&lt;/p&gt;<br /><br />&lt;p&gt;&lt;a&nbsp;href="</span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::login'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Page&nbsp;de&nbsp;login&lt;/a&gt;&lt;/p&gt;<br /><br />&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><h3>Action login : m&eacute;thode _login du module d&#039;authentification</h3>Editez le fichier module/auth/main.php comme suit:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_auth&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_login</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processLogin</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::login'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">message</span><span style="color: #007700">=</span><span style="color: #0000BB">$message</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processLogin</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sLogin</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'login'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sPass</span><span style="color: #007700">=</span><span style="color: #0000BB">sha1</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getListAccount</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;l'utilisateur&nbsp;existe&nbsp;bien<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">checkLoginPass</span><span style="color: #007700">(</span><span style="color: #0000BB">$tAccount</span><span style="color: #007700">,</span><span style="color: #0000BB">$sLogin</span><span style="color: #007700">,</span><span style="color: #0000BB">$sPass</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getAccount</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recuperation&nbsp;de&nbsp;la&nbsp;liste&nbsp;de&nbsp;ses&nbsp;permissions<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tPermission</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Permission</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findByGroup</span><span style="color: #007700">(</span><span style="color: #0000BB">$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">groupe_id</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;purge&nbsp;les&nbsp;permissions&nbsp;en&nbsp;session<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">purge</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//Au&nbsp;moment&nbsp;d'autentifier&nbsp;votre&nbsp;utilisateur,&nbsp;vous&nbsp;allez&nbsp;chercher&nbsp;sa&nbsp;liste&nbsp;de&nbsp;permissions<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//boucle&nbsp;sur&nbsp;les&nbsp;permissions<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$tPermission</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tPermission&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">allowdeny</span><span style="color: #007700">==</span><span style="color: #DD0000">'ALLOW'</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">allow</span><span style="color: #007700">(</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">action</span><span style="color: #007700">,</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">element</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">deny</span><span style="color: #007700">(</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">action</span><span style="color: #007700">,</span><span style="color: #0000BB">$oPermission</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">element</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//redirection&nbsp;vers&nbsp;votre&nbsp;partie&nbsp;privee<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'default::index'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'login/mot&nbsp;de&nbsp;passe&nbsp;incorrect'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_inscription</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processInscription</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::inscription'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">message</span><span style="color: #007700">=</span><span style="color: #0000BB">$message</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processInscription</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">model_Account</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isUnique</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'login'</span><span style="color: #007700">))){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Le&nbsp;login&nbsp;existe&nbsp;deja'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else&nbsp;if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">)!=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password2'</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Les&nbsp;deux&nbsp;mots&nbsp;de&nbsp;passe&nbsp;doivent&nbsp;etre&nbsp;identique'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_Account</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">login</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'login'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">pass</span><span style="color: #007700">=</span><span style="color: #0000BB">sha1</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">groupe_id</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">;</span><span style="color: #FF8000">//a&nbsp;l'inscription&nbsp;on&nbsp;cree&nbsp;des&nbsp;comptes&nbsp;de&nbsp;groupe&nbsp;seulement&nbsp;"read"<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAccount</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Votre&nbsp;compte&nbsp;a&nbsp;bien&nbsp;t&nbsp;cr'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_logout</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">logout</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Remarque</h2>1. Vous pouvez mettre des droits sur ce que vous voulez (un bouton, l&#039;acc&egrave;s &agrave; une page...)<br />2. Vous pouvez facilement g&eacute;rer un model multi groupe en ajoutant une table de liaison entre groupe et account, il faudra simplement changer votre methode findByGroup dans la classe model_Permission<br /><br /><h2>Verification d&#039;un droit</h2>Par exemple on a param&eacute;tr&eacute; comme droit pour le groupe &quot;read-write&quot; la permissions suivante:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />action</span><span style="color: #007700">:</span><span style="color: #0000BB">write<br />element</span><span style="color: #007700">:</span><span style="color: #0000BB">contact<br />allowdeny</span><span style="color: #007700">:</span><span style="color: #0000BB">ALLOW<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div>Pour verifier que l&#039;utilisateur a le droit d&#039;afficher le bouton d&#039;ajout de contact, on utilise la methode &quot;can&quot; de l&#039;objet ACL<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">can</span><span style="color: #007700">(</span><span style="color: #DD0000">'write'</span><span style="color: #007700">,</span><span style="color: #DD0000">'contact'</span><span style="color: #007700">)&nbsp;):</span><span style="color: #0000BB">?&gt;<br /></span>&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'contact::add'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Ajouter&nbsp;un&nbsp;contact&lt;/a&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="usecrudembedded" name="usecrudembedded"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utilisez des CRUD int&eacute;grables</h1><h2>Introduction</h2>Vous souhaitez utiliser un module int&eacute;grable au sein d&#039;un autre module, par exemple on va permettre de saisir des livres &agrave; des auteurs.<br /><br /><h2>Base de donn&eacute;e</h2>On va commencer par cr&eacute;er deux tables: auteur et livre<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">auteur</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">prenom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">livre</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">titre</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">auteur_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Couche mod&egrave;le</h2>Via le builder, g&eacute;n&eacute;rez la couche mod&egrave;le en prenant bien soin pour la ligne &quot;auteur&quot;, de cocher la case &quot;Ajouter une m&eacute;thode getSelect()*&quot; et de selectionner &quot;id&quot; comme cl&eacute; et &quot;nom&quot; comme valeur<br />Ajoutez dans la classe model/model_livre.php une methode qui retournera uniquement les livres de l&#039;auteur s&eacute;lectionn&eacute;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findAllByAuteur</span><span style="color: #007700">(</span><span style="color: #0000BB">$auteur_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;auteur_id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$auteur_id&nbsp;</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Module CRUD auteur</h2>Via le builder, s&eacute;lectionnez &quot;Cr&eacute;er un module CRUD&quot;, cliquez sur &quot;model_auteur&quot; puis pressez le bouton &quot;cr&eacute;er&quot;<br /><br /><h2>Module CRUD int&eacute;grable livre</h2>Dans le builder, cliquez sur &quot;Cr&eacute;er un module CRUD int&eacute;grable [beta]&quot;,<br />s&eacute;lectionnez &quot;model_livre&quot;,<br />indiquez pour le champ &quot;auteur_id&quot; via le menu d&eacute;roulant &quot;Select en utilisant model_auteur::getSelect()&quot;<br />puis pressez le bouton &quot;cr&eacute;er&quot;<br /><h3>Modifions sa m&eacute;thode de liste afin qu&#039;elle liste uniquement les livres de l&#039;auteur s&eacute;lectionn&eacute;</h3>Editez la methode _list() du fichier module/livre/main.php<br />Remplacez<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$tLivre</span><span style="color: #007700">=</span><span style="color: #0000BB">model_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>par<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$tLivre</span><span style="color: #007700">=</span><span style="color: #0000BB">model_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findAllByAuteur</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h3>Forcons le livre ajout&eacute; pour qu&#039;il appartienne &agrave; l&#039;auteur s&eacute;lectionn&eacute; lors d&#039;un ajout</h3>Editez la methode _save() du fichier module/livre/main.php<br />On va y ajoutez le fait de forcer l&#039;auteur dans le cas d&#039;une cr&eacute;ation<br />Remplacez<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$iId</span><span style="color: #007700">==</span><span style="color: #0000BB">null</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oLivre</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_livre</span><span style="color: #007700">;<br />}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oLivre</span><span style="color: #007700">=</span><span style="color: #0000BB">model_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">module_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>par<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$iId</span><span style="color: #007700">==</span><span style="color: #0000BB">null</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oLivre</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_livre</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oLivre</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">auteur_id</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br />}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oLivre</span><span style="color: #007700">=</span><span style="color: #0000BB">model_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">module_livre</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />On va &eacute;galement supprimer le champ auteur_id du formulaire d&#039;ajout, en editant le fichier module/livre/view/new.php<br />Remplacez<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table&nbsp;</span><span style="color: #007700">class=</span><span style="color: #DD0000">"tb_new"</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">titre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"titre"&nbsp;</span><span style="color: #007700">/&gt;&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'titre'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'titre'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;auteur_id&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oPluginHtml</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur_id'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tJoinmodel_auteur</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'auteur_id'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'auteur_id'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><br />&lt;/table&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div>par<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table&nbsp;</span><span style="color: #007700">class=</span><span style="color: #DD0000">"tb_new"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">titre</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"titre"&nbsp;</span><span style="color: #007700">/&gt;&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage&nbsp;</span><span style="color: #007700">and&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'titre'</span><span style="color: #007700">])):&nbsp;echo&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">[</span><span style="color: #DD0000">'titre'</span><span style="color: #007700">]);&nbsp;endif;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br /><br />&lt;/table&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><br /><br /><h2>Ajoutons le module int&eacute;grable &quot;livre&quot; dans la methode &quot;_show()&quot; du module auteur</h2>Copiez le code g&eacute;n&eacute;r&eacute; en ajoutant une precision sur le module parent avec la m&eacute;thode &quot;setRootLink&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//instancier&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">$oModuleLivre</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_livre</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//recupere&nbsp;la&nbsp;vue&nbsp;du&nbsp;module<br /></span><span style="color: #0000BB">$oView</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleLivre</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Dans module/auteur/main.php methode _show()<br /><br />Ce qui donnera:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_show</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)&nbsp;);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::show'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAuteur</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//instancier&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivre</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_livre</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;indique&nbsp;au&nbsp;module&nbsp;integrable&nbsp;les&nbsp;elements&nbsp;du&nbsp;module&nbsp;parent<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oModuleLivre</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setRootLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::show'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recupere&nbsp;la&nbsp;vue&nbsp;du&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=</span><span style="color: #0000BB">$oModuleLivre</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_index</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>On indique ici en premier argument le couple module/action ainsi que les parametres &agrave; prendre en compte, ceci afin que les liens du module int&eacute;gr&eacute; inclut a chaque fois les informations de la page courante<br /><br /><h2>Conclusion</h2>Ainsi, on va pouvoir ajouter des auteurs, et leur ajouter des livres facilement<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="zf1" name="zf1"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser des classes Zend Framework 1</h1><h2>Introduction</h2>Si vous avez besoin d&#039;utiliser une classe Zend Framework 1, il vous suffit de faire la chose suivante.<br /><br /><h2>Utilisation</h2>Il vous suffit d&#039;ajouter le code suivant dans votre fichier index.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">/*&nbsp;decommenter&nbsp;pour&nbsp;utiliser&nbsp;zendframework&nbsp;a&nbsp;partir&nbsp;de&nbsp;la&nbsp;1.12*/<br /></span><span style="color: #0000BB">set_include_path</span><span style="color: #007700">(</span><span style="color: #0000BB">get_include_path</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.</span><span style="color: #DD0000">'/chemin/vers/ZendFramework-1.12.0/library/'</span><span style="color: #007700">);<br /><br />require_once&nbsp;</span><span style="color: #DD0000">'Zend/Loader/Autoloader.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$autoloader&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Zend_Loader_Autoloader</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$autoloader</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setFallbackAutoloader</span><span style="color: #007700">(</span><span style="color: #0000BB">false</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ensuite il vous suffira naturellement d&#039;instancier les classes n&eacute;cessaires, par exemple<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$oZendDate</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">Zend_Date</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$oZendDate</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">Zend_Date</span><span style="color: #007700">::</span><span style="color: #0000BB">HOUR</span><span style="color: #007700">);<br /><br />print&nbsp;</span><span style="color: #0000BB">$oZendDate</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">toString</span><span style="color: #007700">(</span><span style="color: #DD0000">'d&nbsp;MMM&nbsp;Y'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><br /><p><a id="zf2" name="zf2"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser des classes Zend Framework 2</h1><h2>Introduction</h2>Si vous avez besoin d&#039;utiliser une classe Zend Framework 2, il vous suffit de faire la chose suivante.<br /><br /><h2>Utilisation</h2>Il vous suffit d&#039;ajouter le code suivant dans votre fichier index.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">/*&nbsp;decommenter&nbsp;pour&nbsp;utiliser&nbsp;zendframework&nbsp;a&nbsp;partir&nbsp;de&nbsp;la&nbsp;1.12*/<br /></span><span style="color: #0000BB">set_include_path</span><span style="color: #007700">(</span><span style="color: #0000BB">get_include_path</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.</span><span style="color: #DD0000">'/chemin/vers/ZendFramework-2.1.5/library/'</span><span style="color: #007700">);<br /><br />require_once&nbsp;</span><span style="color: #DD0000">'Zend/Loader/StandardAutoloader.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$loader&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Zend</span><span style="color: #007700">\</span><span style="color: #0000BB">Loader</span><span style="color: #007700">\</span><span style="color: #0000BB">StandardAutoloader</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$loader</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">registerNamespace</span><span style="color: #007700">(</span><span style="color: #DD0000">'Zend'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Zend/'</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #0000BB">setFallbackAutoloader</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$loader</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">register</span><span style="color: #007700">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Apr&egrave;s la ligne &quot;spl_autoload_register(array(&#039;_root&#039;,&#039;autoload&#039;));&quot;<br /><br />Ensuite il vous suffira naturellement d&#039;instancier les classes n&eacute;cessaires, par exemple<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$oZendDate</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">Zend</span><span style="color: #007700">\</span><span style="color: #0000BB">Stdlib</span><span style="color: #007700">\</span><span style="color: #0000BB">DateTime</span><span style="color: #007700">();<br /><br />print&nbsp;</span><span style="color: #0000BB">$oZendDate</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">format</span><span style="color: #007700">(</span><span style="color: #DD0000">'d&nbsp;M&nbsp;Y'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><br /><p><a id="zf3" name="zf3"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser des classes Zend Framework 3</h1><h2>Introduction</h2>Si vous avez besoin d&#039;utiliser une classe Zend Framework 3, il vous suffit de faire la chose suivante.<br /><br /><h2>Utilisation</h2>Il vous suffit de faire 2 choses:<br />1. installez Zend Framework 3 en utilisant composer<br />Pour cela, cr&eacute;ez un fichier &quot;composer.json&quot; &agrave; la racine de votre projet mkf<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"name"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"votreProjet"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"description"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"votre&nbsp;projet"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"type"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"project"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"prefer-stable"</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"require"</span><span style="color: #007700">:&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"php"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^5.6&nbsp;||&nbsp;^7.0"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"zendframework/zend-component-installer"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^1.0&nbsp;||&nbsp;^0.7&nbsp;||&nbsp;^1.0.0-dev@dev"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"zendframework/zend-mvc"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^3.0.1"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"zfcampus/zf-development-mode"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^3.0"<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>2. lancer l&#039;installation composer (<a href="https://getcomposer.org/">plus d&#039;infos sur composer </a>)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />composer&nbsp;install<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><br />Ensuite il faut ajouter le code suivant au d&eacute;but de votre fichier index.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #0000BB">__DIR__&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'/../vendor/autoload.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><br />Enfin il vous suffira naturellement d&#039;instancier les classes n&eacute;cessaires, par exemple dans votre module ou ailleurs:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$validator&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Zend</span><span style="color: #007700">\</span><span style="color: #0000BB">Validator</span><span style="color: #007700">\</span><span style="color: #0000BB">EmailAddress</span><span style="color: #007700">();<br /><br />if&nbsp;(</span><span style="color: #0000BB">$validator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">(</span><span style="color: #0000BB">$email</span><span style="color: #007700">))&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">print&nbsp;</span><span style="color: #DD0000">"email&nbsp;ok"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$validator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessages</span><span style="color: #007700">()&nbsp;as&nbsp;</span><span style="color: #0000BB">$messageId&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">)&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Validation&nbsp;en&nbsp;erreur&nbsp;'%s':&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$messageId</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$message</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><br /><br /><p><a id="sf4" name="sf4"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser des classes Symfony 4</h1><h2>Introduction</h2>Si vous avez besoin d&#039;utiliser une classe Symfony 4, il vous suffit de faire la chose suivante.<br /><br /><h2>Utilisation</h2>Il vous suffit de faire 2 choses:<br />1. installez Symfony 4 en utilisant composer<br />Pour cela, cr&eacute;ez un fichier &quot;composer.json&quot; &agrave; la racine de votre projet mkf<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"name"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"votreProjet"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"description"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"votre&nbsp;projet"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"type"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"project"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"prefer-stable"</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"require"</span><span style="color: #007700">:&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"php"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^5.6&nbsp;||&nbsp;^7.0"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"symfony/framework-bundle"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^4.2"</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"symfony/validator"</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"^4.2"<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>2. lancer l&#039;installation composer (<a href="https://getcomposer.org/">plus d&#039;infos sur composer </a>)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />composer&nbsp;install<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><br />Ensuite il faut ajouter le code suivant au d&eacute;but de votre fichier index.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #0000BB">__DIR__&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'/../vendor/autoload.php'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><br />Enfin il vous suffira naturellement d&#039;instancier les classes n&eacute;cessaires, par exemple dans votre module ou ailleurs:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$myString</span><span style="color: #007700">=</span><span style="color: #DD0000">''</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$validator&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Component</span><span style="color: #007700">\</span><span style="color: #0000BB">Validator</span><span style="color: #007700">\</span><span style="color: #0000BB">Validation</span><span style="color: #007700">::</span><span style="color: #0000BB">createValidator</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$violations&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$validator</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">validate</span><span style="color: #007700">(</span><span style="color: #0000BB">$myString</span><span style="color: #007700">,&nbsp;[<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">new&nbsp;\</span><span style="color: #0000BB">Symfony</span><span style="color: #007700">\</span><span style="color: #0000BB">Component</span><span style="color: #007700">\</span><span style="color: #0000BB">Validator</span><span style="color: #007700">\</span><span style="color: #0000BB">Constraints</span><span style="color: #007700">\</span><span style="color: #0000BB">NotBlank</span><span style="color: #007700">(),<br />]);<br /><br />if&nbsp;(</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">!==&nbsp;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$violations</span><span style="color: #007700">))&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$violations&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$violation</span><span style="color: #007700">)&nbsp;{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$violation</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">().</span><span style="color: #DD0000">'&lt;br&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">print&nbsp;</span><span style="color: #DD0000">"myString&nbsp;notBlank"</span><span style="color: #007700">;<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><br /><p><a id="token" name="token"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser les jetons pour &eacute;viter les failles XSRF</h1><h2>Introduction</h2>Pour se pr&eacute;munir des failles XSRF, on passe par l&#039;utilisation des jetons: lors de la cr&eacute;ation du formualire, on cr&eacute;&eacute; un jeton, et lorsque celui-ci est envoy&eacute; on v&eacute;rifie que le jeton est le m&ecirc;me.<br />Celui-ci doit donc &ecirc;tre unique ;) Plus d&#039;informations sur le XSRF ici: http://fr.wikipedia.org/wiki/Cross-site_request_forgery<br /><br /><h2>Phase 1: Cot&eacute; controlleur</h2>Lors de la cr&eacute;ation de la vue contenant le formulaire, on cr&eacute;&eacute; un jeton avec le plugin plugin_xsrf<br />On passe celui-ci &agrave; notre vue<br />Fichier module/article/main.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_new</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;cr&nbsp;une&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'article::new'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;un&nbsp;jeton<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;ce&nbsp;jeton&nbsp;&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;le&nbsp;tableau&nbsp;de&nbsp;message&nbsp;&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">messageToken</span><span style="color: #007700">=</span><span style="color: #0000BB">$messageToken</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ajoute&nbsp;la&nbsp;vue&nbsp;au&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Phase 2: cot&eacute; vue</h2>On ajoute un champ cach&eacute; contenant ce jeton, on affichera &eacute;galement les messages du jeton si celui-ci est &eacute;rron&eacute;<br />Fichier module/article/view/new.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"hidden"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"token"&nbsp;</span><span style="color: #0000BB">value</span><span style="color: #007700">=</span><span style="color: #DD0000">"&lt;?php&nbsp;echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #DD0000">?&gt;"&nbsp;</span><span style="color: #007700">/&gt;<br />&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">messageToken&nbsp;</span><span style="color: #007700">and&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">messageToken</span><span style="color: #007700">!=</span><span style="color: #DD0000">''</span><span style="color: #007700">):&nbsp;echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">messageToken</span><span style="color: #007700">;&nbsp;endif;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br /><h2>Phase 3: cot&eacute; traitement du formulaire</h2>Lors de l&#039;envoi du jeton, on v&eacute;rifie que celui-ci est correcte, et on renvoie le message d&#039;erreur $messageToken (ensuite assign&eacute; &agrave; la vue)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">process</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$messageToken</span><span style="color: #007700">=</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//traitement&nbsp;du&nbsp;formulaire<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;aucun&nbsp;formulaire&nbsp;envoye&nbsp;on&nbsp;renvoi&nbsp;null<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;il&nbsp;est&nbsp;invalide,&nbsp;on&nbsp;renvoie&nbsp;le&nbsp;message&nbsp;d'erreur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$messageToken</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$messageToken</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//traitement&nbsp;normal&nbsp;du&nbsp;formulaire&nbsp;(enregistrement&nbsp;en&nbsp;base...)<br /><br /></span><span style="color: #007700">}<br /><br />public&nbsp;function&nbsp;</span><span style="color: #0000BB">_new</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//appel&nbsp;&nbsp;la&nbsp;mthode&nbsp;de&nbsp;traitement&nbsp;du&nbsp;formulaire,&nbsp;et&nbsp;rcupration&nbsp;du&nbsp;message&nbsp;de&nbsp;token<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$messageToken</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">process</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;cr&nbsp;une&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'article::new'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;un&nbsp;jeton<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;ce&nbsp;jeton&nbsp;&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;assigne&nbsp;le&nbsp;tableau&nbsp;de&nbsp;message&nbsp;&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">messageToken</span><span style="color: #007700">=</span><span style="color: #0000BB">$messageToken</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ajoute&nbsp;la&nbsp;vue&nbsp;au&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="cachesite" name="cachesite"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Faire un site avec un cache html complet</h1><h2>Introduction</h2>Dans le cas de beaucoup de site, le contenu change peu (moins de 10 fois par jour), c&#039;est le cas par exemple des blogs, ou des sites institutionnels.<br />Dans ces cas l&agrave; certains laisse le site requeter en permanence la base de donn&eacute;e malgr&eacute; le fait que cette donn&eacute;e ne change pas, d&#039;autres pense &agrave; mettre des m&eacute;canisme de cache de zone en place...<br />Mais pour ces m&eacute;canismes de cache, on utilise tout de m&ecirc;me du php avec des acc&egrave;s i/o pour verifier la valididt&eacute; du cache...<br />Ici je vais vous indiquer comment faire un site dynamique (modifiable avec un backoffice) mais dont les clients ne requeterons que des pages html (pas de process php, pas de requete en base de donn&eacute;e)<br />Les avantages:<br />- base de donn&eacute;e peu solicit&eacute;: juste &agrave; la g&eacute;n&eacute;ration de cache et lors de la modification de donn&eacute;es<br />- de tr&egrave;s bonnes performances, apache ne faisant que retourner de simples pages html<br />- cot&eacute; s&eacute;curit&eacute;: aucune faille xss,xsrf, nullbyte, sql injection ou autre: le client n&#039;a acc&egrave;s qu&#039;&agrave; des pages html<br /><br /><h2>Pr&eacute;sentation de l&#039;architecture</h2>Le site se divise en 2: d&#039;un cot&eacute; le site &quot;backoffice&quot; qui est bas&eacute; sur le mkframework et va int&eacute;ragir avec notre base de donn&eacute;e<br />De l&#039;autre notre site public &quot;html&quot;, celui qui va &ecirc;tre visit&eacute; par nos visiteurs ainsi que les moteurs de recherche<br /><br /><h2>Partie publique</h2>Cr&eacute;&eacute;z sur votre serveur un repertoire web qui contiendra le cache de votre site, pensez bien &agrave; ajouter vos css et autres images de pr&eacute;sentation/contenu.<br />Par exemple /var/www/monSite<br /><br /><h2>Partie backoffice</h2>De ce cot&eacute; l&agrave;, faites votre site &quot;normalement&quot; avec les CRUDs n&eacute;c&eacute;ssaires... pour administrer vos donn&eacute;es, n&#039;oubliez pas le module d&#039;authentification.<br />Faites &eacute;galement votre partie publique: le site tel qu&#039;il devra &ecirc;tre affich&eacute; pour l&#039;internaute<br /><br />Une chose diff&egrave;re par la suite: dans la partie enregistrement de votre donn&eacute;e en base, vous allez g&eacute;n&eacute;rer le cache de votre site en vous appuyant sur les modules publiques de votre site<br />Par exemple pour un blog:<br />Cr&eacute;er les modules CRUD avec un pr&eacute;fixe &quot;admin&quot; et les modules d&#039;affichage en lecture seule avec un prefixe &quot;public&quot;<br />Vous avez donc 3 modules:<br />- adminArticle (permet de creer des nouveaux articles)<br />- adminAuteur (permet de cr&eacute;er les auteurs)<br />- publicArticle (permet de lister et d&#039;afficher les articles en d&eacute;tail)<br /><h2>Url rewriting</h2>Avant de generer notre cache, il faudrait d&eacute;finir des r&egrave;gles d&#039;url rewriting utilisant des adresses plus propre qui seront utilis&eacute;es pour cr&eacute;er les pages html<br />Editez votre fichier conf/site.ini.php et indiquer dans la section urlrewriting<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">[</span><span style="color: #0000BB">urlrewriting</span><span style="color: #007700">]<br /></span><span style="color: #0000BB">enabled</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div>Ensuite &eacute;ditez le fichier des routes (conf/routing.php) pour ajouter deux routes<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$tab</span><span style="color: #007700">=array(<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'index.html'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'nav'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'publicArticle::list'</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">),<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'article_:id:.html'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&nbsp;array(<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'nav'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'publicArticle::show'</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'tParam'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">),<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'404'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'nav'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'publicArticle'</span><span style="color: #007700">),<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>L&#039;une utilise index.html pour appeler la m&eacute;thode _list() du module module_publicArticle<br />L&#039;autre utilise article_ suivi de l&#039;id de l&#039;article &agrave; afficher via la m&eacute;thode _show du m&ecirc;me module<br /><br /><h2>G&eacute;n&eacute;ration du cache</h2>Imaginons deux m&eacute;thodes dans publicArticle: _list() et _show()<br />Vous pouvez dupliquer votre m&eacute;thode _list pour faire une methode qui generera le cache:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">generateCacheList</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;appelle&nbsp;la&nbsp;methode&nbsp;before(),<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//comme&nbsp;le&nbsp;ferait&nbsp;le&nbsp;framework<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//pour&nbsp;crer&nbsp;le&nbsp;layout,&nbsp;charger&nbsp;les&nbsp;ventuels&nbsp;menu...<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">before</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;appelle&nbsp;l'action&nbsp;&nbsp;mettre&nbsp;en&nbsp;cache:<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_list</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//c'est&nbsp;ici&nbsp;que&nbsp;cela&nbsp;diffre:&nbsp;on&nbsp;recupre&nbsp;la&nbsp;sortie<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$sContent</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getOutput</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;demande&nbsp;au&nbsp;framework&nbsp;de&nbsp;gnrer&nbsp;le&nbsp;mme&nbsp;lien&nbsp;que&nbsp;celui&nbsp;utilis&nbsp;dans&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$sUrl</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'publicArticle::list'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;l'enregistre&nbsp;dans&nbsp;le&nbsp;repertoire&nbsp;de&nbsp;notre&nbsp;site&nbsp;public<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_file</span><span style="color: #007700">(</span><span style="color: #DD0000">'/var/www/monSite/'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sUrl</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setContent</span><span style="color: #007700">(</span><span style="color: #0000BB">$sContent</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Idem pour la page d&#039;affichage d&#039;un article:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">generateCacheShow</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;appelle&nbsp;la&nbsp;methode&nbsp;before(),<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//comme&nbsp;le&nbsp;ferait&nbsp;le&nbsp;framework<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//pour&nbsp;crer&nbsp;le&nbsp;layout,&nbsp;charger&nbsp;les&nbsp;ventuels&nbsp;menu...<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">before</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;force&nbsp;le&nbsp;paramtre&nbsp;d'id&nbsp;pour&nbsp;afficher&nbsp;le&nbsp;bon&nbsp;article<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">setParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;appelle&nbsp;l'action&nbsp;&nbsp;mettre&nbsp;en&nbsp;cache:<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">_show</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//c'est&nbsp;ici&nbsp;que&nbsp;cela&nbsp;diffre:&nbsp;on&nbsp;recupre&nbsp;la&nbsp;sortie<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$sContent</span><span style="color: #007700">=</span><span style="color: #0000BB">$oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getOutput</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;demande&nbsp;au&nbsp;framework&nbsp;de&nbsp;gnerer&nbsp;le&nbsp;mme&nbsp;lien&nbsp;que&nbsp;celui&nbsp;utilis&nbsp;dans&nbsp;la&nbsp;vue<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$sUrl</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'publicArticle::show'</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$id</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;l'enregistre&nbsp;dans&nbsp;le&nbsp;repertoire&nbsp;de&nbsp;notre&nbsp;site&nbsp;public<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_file</span><span style="color: #007700">(</span><span style="color: #DD0000">'/var/www/monSite/'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sUrl</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setContent</span><span style="color: #007700">(</span><span style="color: #0000BB">$sContent</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oFile</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ainsi, dans votre module CRUD, lors de l&#039;enregistrement d&#039;un article<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processSave</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;le&nbsp;module&nbsp;public<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oModuleArticlePublic</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">module_publicArticle</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;appelle&nbsp;la&nbsp;methode&nbsp;de&nbsp;generation&nbsp;du&nbsp;cache&nbsp;de&nbsp;liste&nbsp;d'articles<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oModuleArticlePublic</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">generateCacheList</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//puis&nbsp;pour&nbsp;l'article&nbsp;ajout/modifi<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$id</span><span style="color: #007700">=</span><span style="color: #0000BB">$oArticle</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;recupere&nbsp;son&nbsp;id&nbsp;et&nbsp;l'on&nbsp;demande&nbsp;au&nbsp;module&nbsp;public<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//de&nbsp;gnrer&nbsp;le&nbsp;cache&nbsp;de&nbsp;sa&nbsp;page&nbsp;d'affichage<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oModuleArticlePublic</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">generateCacheShow</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//une&nbsp;fois&nbsp;enregistre&nbsp;on&nbsp;redirige&nbsp;(vers&nbsp;la&nbsp;page&nbsp;liste&nbsp;du&nbsp;CRUD)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::list'</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>A chaque fois que vous allez ajouter, modifier un article, le site &quot;statique&quot; html sera mis &agrave; jour automatiquement.<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="tableguriddo" name="tableguriddo"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Impl&eacute;menter un tableau Guriddo</h1><h2>Introduction</h2>La cr&eacute;ation des tableau web est souvent une tache chronophage, dans ce tutoriel, apprenez &agrave; integrer simplement un tableau Guriddo.<br /><br /><h2>Mod&egrave;le</h2>Dans ce tutoriel, nous allons partir d&#039;une base guriddo comprenant une table auteur<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">auteur</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">prenom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">30</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Cr&eacute;ez via le builder la classe mod&egrave;le model_auteur.php<br /><br /><h2>T&eacute;l&eacute;chargement du module Guriddo et installation</h2>Sur le site du mkframework, rubrique &quot;T&eacute;l&eacute;chargez les modules&quot;<br />Cliquez sur Module Table Guriddo<br />Vous avez une page vous pr&eacute;sentant ce module et la mani&egrave;re de l&#039;utiliser, t&eacute;l&eacute;chargez l&#039;archive zip et d&eacute;sarchivez-la dans le r&eacute;pertoire module de votre projet.<br /><br />Attention: dans le r&eacute;pertoire d&eacute;sarchivez, il y a un r&eacute;pertoire &quot;public&quot; qui contient un r&eacute;pertoire guriddo, d&eacute;placez celui-ci dans le r&eacute;pertoire public de votre projet<br /><br /><h2>Utilisation</h2>Dans votre module, par exemple &quot;default&quot;<br />Dans l&#039;action correspondante<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_index</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;instancie&nbsp;le&nbsp;module<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">module_guriddo</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;indique&nbsp;le&nbsp;nombre&nbsp;de&nbsp;lignes&nbsp;par&nbsp;page<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setPaginationLimit</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//l'id&nbsp;de&nbsp;la&nbsp;div&nbsp;html<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setId</span><span style="color: #007700">(</span><span style="color: #DD0000">'monId'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;definit&nbsp;la&nbsp;hauteur&nbsp;du&nbsp;tableau&nbsp;(en&nbsp;pixels)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setHeight</span><span style="color: #007700">(</span><span style="color: #0000BB">120</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setWidth</span><span style="color: #007700">(</span><span style="color: #0000BB">600</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//$oTable-&gt;setDefaultSortField('firstname');<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//methode&nbsp;indiquant&nbsp;la&nbsp;page&nbsp;ajax&nbsp;permettant&nbsp;de&nbsp;mettre&nbsp;a&nbsp;jour&nbsp;le&nbsp;tableau<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setJsonLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'default::listJson'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addHeaderWithOrder</span><span style="color: #007700">(</span><span style="color: #DD0000">'ID'</span><span style="color: #007700">,</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addHeaderWithOrder</span><span style="color: #007700">(</span><span style="color: #DD0000">'Nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addHeaderWithOrder</span><span style="color: #007700">(</span><span style="color: #DD0000">'Prenom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$oTable</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">build</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//assigner&nbsp;la&nbsp;vue&nbsp;retournee&nbsp;a&nbsp;votre&nbsp;layout<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ce module utilisant de l&#039;ajax pour int&eacute;ragir, nous allons ajouter la m&eacute;thode correspondante, ici default::listJson<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_listJson</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">=</span><span style="color: #0000BB">module_guriddo</span><span style="color: #007700">::</span><span style="color: #0000BB">getJson</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;precise&nbsp;la&nbsp;liste&nbsp;des&nbsp;champs&nbsp;autorise&nbsp;a&nbsp;etre&nbsp;trie<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setSortFieldAllowed</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">hasFilter</span><span style="color: #007700">()){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findTotalFiltered</span><span style="color: #007700">(</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListFilter</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setTotal</span><span style="color: #007700">(</span><span style="color: #0000BB">$count</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tData</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findListFilteredAndLimitOrderBy</span><span style="color: #007700">(</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListFilter</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getStart</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getLimit</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSortField</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSortSide</span><span style="color: #007700">());<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findTotal</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setTotal</span><span style="color: #007700">(</span><span style="color: #0000BB">$count</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tData</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findListLimitOrderBy</span><span style="color: #007700">(</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getStart</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getLimit</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSortField</span><span style="color: #007700">(),</span><span style="color: #0000BB">$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSortSide</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setData</span><span style="color: #007700">(</span><span style="color: #0000BB">$tData</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;definit&nbsp;ici&nbsp;les&nbsp;colonnes&nbsp;json&nbsp;qui&nbsp;seront&nbsp;recus<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setId</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addColumn</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addColumn</span><span style="color: #007700">(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addColumn</span><span style="color: #007700">(</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oJson</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">show</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Comme vous le voyez ici, on appelle 4 m&eacute;thodes dans la couche mod&egrave;le model_auteur: cela fonctionne par couple<br />Le premier couple pour le simple tri/pagination inclut une m&eacute;thode retournant le total et une autre retournant la partie pagin&eacute;e.<br />Le second couple pour le tri/pagin&eacute; + filtre inclut lui aussi une m&eacute;thode retournant le total des enregistrements avec ce filtre et la m&eacute;thode retournant la partie pagin&eacute;e selon ce crit&egrave;re.<br /><br />Le premier couple &agrave; ajouter dans votre classe mod&egrave;le model_auteur<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//methode&nbsp;listant&nbsp;le&nbsp;nombre&nbsp;total&nbsp;d'enregistrements<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findTotal</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oRow</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOneSimple</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;count(*)&nbsp;as&nbsp;total&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">total</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">//methode&nbsp;retournant&nbsp;les&nbsp;enregistrements&nbsp;trie&nbsp;et&nbsp;pagine<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findListLimitOrderBy</span><span style="color: #007700">(</span><span style="color: #0000BB">$start</span><span style="color: #007700">,</span><span style="color: #0000BB">$limit</span><span style="color: #007700">,</span><span style="color: #0000BB">$sField</span><span style="color: #007700">,</span><span style="color: #0000BB">$side</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findManySimple</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;ORDER&nbsp;BY&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sField</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$side</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;LIMIT&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$start</span><span style="color: #007700">.</span><span style="color: #DD0000">','</span><span style="color: #007700">.</span><span style="color: #0000BB">$limit</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Le second couple<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//methode&nbsp;listant&nbsp;le&nbsp;nombre&nbsp;total&nbsp;d'enregistrements&nbsp;filtre<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findTotalFiltered</span><span style="color: #007700">(</span><span style="color: #0000BB">$tFilter</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tFilter&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sField&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$sValue</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tWhere</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$sField</span><span style="color: #007700">.</span><span style="color: #DD0000">'=?'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tValue</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$sValue</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oRow</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOneSimple</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;count(*)&nbsp;as&nbsp;total&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">'AND'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tWhere</span><span style="color: #007700">).</span><span style="color: #DD0000">''</span><span style="color: #007700">,</span><span style="color: #0000BB">$tValue</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">total</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">//methode&nbsp;retournant&nbsp;les&nbsp;enregistrements&nbsp;trie&nbsp;et&nbsp;pagine&nbsp;et&nbsp;filtre<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findListFilteredAndLimitOrderBy</span><span style="color: #007700">(</span><span style="color: #0000BB">$tFilter</span><span style="color: #007700">,</span><span style="color: #0000BB">$start</span><span style="color: #007700">,</span><span style="color: #0000BB">$limit</span><span style="color: #007700">,</span><span style="color: #0000BB">$sField</span><span style="color: #007700">,</span><span style="color: #0000BB">$side</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tFilter&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sField&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$sValue</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tWhere</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$sField</span><span style="color: #007700">.</span><span style="color: #DD0000">'=?'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tValue</span><span style="color: #007700">[]=</span><span style="color: #0000BB">$sValue</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findManySimple</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">'AND'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tWhere</span><span style="color: #007700">).</span><span style="color: #DD0000">'&nbsp;ORDER&nbsp;BY&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sField</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$side</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;LIMIT&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$start</span><span style="color: #007700">.</span><span style="color: #DD0000">','</span><span style="color: #007700">.</span><span style="color: #0000BB">$limit</span><span style="color: #007700">,</span><span style="color: #0000BB">$tValue</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="debug" name="debug"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Utiliser la barre de debug</h1><h2>Introduction</h2>Il est souvent utile lors du developpement d&#039;une application web de pouvoir connaitre les variables d&#039;environnements (GET,POST), de savoir la valeur d&#039;une variable ou de chronom&eacute;trer ce qui prend du temps dans votre processus.<br />Pour cela, la barre debug est l&agrave;<br /><img src="data/img/tutoDebug_barre.png" /><br />Comme vous pouvez le voir elle comporte plusieurs boutons ainsi que des informations<br /><h3>Bouton &quot;masquer&quot;</h3>Comme l&#039;indique son nom, il permet juste de masquer la barre temporairement<br /><h3>Champ &quot;Time&quot;</h3>Il indique le temps de chargement de la page<br /><h3>Bouton &quot;Times&quot;</h3>Affiche les chrono que vous avez d&eacute;fini<br />On peut ajouter deux types de chrono: les chronos fixes, vous demandez &agrave; cet instant quel temps<br /><img src="data/img/tutoDebug_chronoFixe.png" /><br />En l&#039;appelant ainsi<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">addChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'debut&nbsp;recuperation&nbsp;de&nbsp;tAuteur'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">addChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'fin&nbsp;recuperation&nbsp;de&nbsp;tAuteur'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">$tAuteur</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et les chronos &quot;p&eacute;riode&quot; o&ugrave; vous indiquez quand vous commencez et quand vous finissez le chrono avec un id particulier, ceci afin de permettre d&#039;avoir plusieurs chrono dans la m&ecirc;me page.<br /><img src="data/img/tutoDebug_chronoPeriod.png" /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//debut&nbsp;chrono&nbsp;temps&nbsp;total&nbsp;de&nbsp;la&nbsp;methode<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">startChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'tpsTotalView'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//debut&nbsp;chrono&nbsp;recup&nbsp;auteur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">startChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'recupAuteur'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//fin&nbsp;chrono&nbsp;recup&nbsp;auteur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">stopChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'recupAuteur'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">$tAuteur</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//fin&nbsp;chrono&nbsp;temps&nbsp;total&nbsp;de&nbsp;la&nbsp;methode<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">stopChrono</span><span style="color: #007700">(</span><span style="color: #DD0000">'tpsTotalView'</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h3>Boutons &quot;$_GET&quot;,&quot;$_POST&quot;,&quot;$_SERVER&quot; (et quand disponible &quot;$_SESSION&quot;)</h3>Ces boutons permettent simplement d&#039;afficher ces tableaux d&#039;environnements<br /><h3>Champs &quot;Module&quot; et &quot;Action&quot;</h3>Vous indique quel couple module/action est appel&eacute; sur cette page<br /><h3>Boutons &quot;Connexions&quot; et &quot;Config&quot;</h3>Vous affiche les variables de configuration de votre application en couleur<br /><h3>Bouton &quot;Permissions&quot;</h3>Lorsque vous developpez une application avec une gestion de droits, ce bouton affiche les demandes de permissions: et affiche la demande en vert ou rouge selon que le droit est autoris&eacute; ou non<br />Pour rappel, pour demander un droit<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">if(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getACL</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">can</span><span style="color: #007700">(</span><span style="color: #DD0000">'verbe'</span><span style="color: #007700">,</span><span style="color: #DD0000">'element'</span><span style="color: #007700">)&nbsp;){<br /></span><span style="color: #FF8000">//code<br /></span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><h3>Bouton &quot;Spy variables&quot;</h3>Affiche le ou les variables que vous avez demand&eacute; d&#039;afficher.<br />Par exemple dans une page vous faites une requ&ecirc;te, recup&eacute;r&eacute; un tableau d&#039;auteur,vous pouvez le mettre en spy pour verifier les valeurs et nom des champs.<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">model_auteur</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auteur::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tAuteur</span><span style="color: #007700">=</span><span style="color: #0000BB">$tAuteur</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//ajout&nbsp;d'un&nbsp;espion&nbsp;sur&nbsp;la&nbsp;variable&nbsp;tAuteur<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;plugin_debug</span><span style="color: #007700">::</span><span style="color: #0000BB">addSpy</span><span style="color: #007700">(</span><span style="color: #DD0000">'tAuteur'</span><span style="color: #007700">,</span><span style="color: #0000BB">$tAuteur</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><img src="data/img/tutoDebug_spy.png" /><br />Ceci &eacute;vite d&#039;&eacute;crire des print, print_r dans tous les sens dans votre code, et une fois en production c&#039;est desactiv&eacute;.<br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="listelinked" name="listelinked"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Faire des menus d&eacute;roulants li&eacute;s</h1><h2>Introduction</h2>L&#039;id&eacute;e est de faire trois menus d&eacute;roulant d&eacute;pendant les uns des autres.<br />Par exemple, vous souhaitez renseigner des restaurants en indiquant la ville via 3 niveaux: region, d&eacute;partement et enfin la ville.<br />On souhaite s&eacute;lectionner la r&eacute;gion limitant ainsi la liste des d&eacute;partements, puis s&eacute;lectionner le d&eacute;partement pour filtrer les villes.<br /><br />Pour commencer, nous partirons de la base suivante:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">region</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">departement</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">region_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">ville</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">departement_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Nous remplissions celle-ci<br />Puis nous g&eacute;n&eacute;rons la couche mod&egrave;le<br /><img src="data/img/tutoListeLinked_builderCoucheM.png" /><br /><br />Cr&eacute;ons maintenant notre table restaurant<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">restaurant</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">150</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">ville_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">INT&nbsp;NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>G&eacute;n&eacute;rons la couche mod&egrave;le du restaurant gr&acirc;ce au builder<br /><h2>Cr&eacute;ons le module d&#039;ajout de restaurant</h2>Toujours dans le builder, cr&eacute;ez &quot;un module&quot; avec deux actions &quot;liste&quot; et &quot;ajouter&quot;<br /><img src="data/img/tutoListeLinked_builderCreaModule.png" /><br />On a donc un module normal type, on va ajouter dans la m&eacute;thode _ajouter une recup&eacute;ration des 3 listes r&eacute;gion/d&eacute;partement et ville<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_restaurant&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'template1'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//$this-&gt;oLayout-&gt;addModule('menu','menu::index');<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_ajouter</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tDepartement</span><span style="color: #007700">=array();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tVille</span><span style="color: #007700">=array();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recuperation&nbsp;de&nbsp;toutes&nbsp;les&nbsp;regions<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tRegion</span><span style="color: #007700">=</span><span style="color: #0000BB">model_region</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'region_id'</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recuperation&nbsp;des&nbsp;departement&nbsp;selon&nbsp;la&nbsp;region<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tDepartement</span><span style="color: #007700">=</span><span style="color: #0000BB">model_departement</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'region_id'</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'departement_id'</span><span style="color: #007700">)){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//recuperation&nbsp;des&nbsp;villes&nbsp;selon&nbsp;le&nbsp;departement<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tVille</span><span style="color: #007700">=</span><span style="color: #0000BB">model_ville</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'departement_id'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'restaurant::ajouter'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tRegion</span><span style="color: #007700">=</span><span style="color: #0000BB">$tRegion</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tDepartement</span><span style="color: #007700">=</span><span style="color: #0000BB">$tDepartement</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tVille</span><span style="color: #007700">=</span><span style="color: #0000BB">$tVille</span><span style="color: #007700">;<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">after</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">show</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ici, on imbrique une r&eacute;cup&eacute;ration des regions, departement et ville<br />Renseignons les 3 m&eacute;thodes de la couche mod&egrave;le appel&eacute;es:<br />Fichier model_region.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tab</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">=array(</span><span style="color: #0000BB">null</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$tab</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tab&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">[&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$tSelect</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Fichier model_departement.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findAllByRegion</span><span style="color: #007700">(</span><span style="color: #0000BB">$region_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;region_id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$region_id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #0000BB">$region_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tab</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAllByRegion</span><span style="color: #007700">(</span><span style="color: #0000BB">$region_id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">=array(</span><span style="color: #0000BB">null</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$tab</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tab&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">[&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$tSelect</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Fichier model_ville.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findAllByDepartement</span><span style="color: #007700">(</span><span style="color: #0000BB">$departement_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;departement_id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$departement_id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #0000BB">$departement_id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tab</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findAllByDepartement</span><span style="color: #007700">(</span><span style="color: #0000BB">$departement_id</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">=array(</span><span style="color: #0000BB">null</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$tab</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tab&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tSelect</span><span style="color: #007700">[&nbsp;</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oRow</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$tSelect</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>La partie mod&egrave;le termin&eacute;e, on peut construire notre formulaire qui permettra d&#039;utiliser ces listes li&eacute;es.<br />En &eacute;ditant le fichier module/restaurant/view/ajouter.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;$oForm</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_form</span><span style="color: #007700">();</span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;form&nbsp;action=""&nbsp;method="POST"&gt;<br /><br />&lt;p&gt;Region&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'region_id'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tRegion</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'onchange'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'submit()'</span><span style="color: #007700">))</span><span style="color: #0000BB">?&gt;</span>&lt;/p&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tDepartement</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&lt;p&gt;Departement&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'departement_id'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tDepartement</span><span style="color: #007700">,array(</span><span style="color: #DD0000">'onchange'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'submit()'</span><span style="color: #007700">))</span><span style="color: #0000BB">?&gt;</span>&lt;/p&gt;<br /><br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tVille</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Ville&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSelect</span><span style="color: #007700">(</span><span style="color: #DD0000">'ville_id'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tVille</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>&lt;/p&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br />&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;p&gt;Restaurant:&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>&lt;/p&gt;<br />&lt;input&nbsp;type="submit"&nbsp;value="Ajouter&nbsp;restaurant"/&gt;<br />&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div>On voit ici l&#039;id&eacute;e d&#039;imbriquer les trois menus d&eacute;roulant li&eacute;s les uns aux autres.<br /><img src="data/img/tutoListeLinked_builderView1.png" /><br /><img src="data/img/tutoListeLinked_builderView2.png" /><br /><img src="data/img/tutoListeLinked_builderView3.png" /><br /><img src="data/img/tutoListeLinked_builderView4.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="crudguriddo" name="crudguriddo"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er un module CRUD Guriddo (Create Read Update Delete)</h1>Apr&egrave;s avoir cr&eacute;&eacute; votre application, configurer son fichier de connexion et g&eacute;n&eacute;r&eacute; la partie model.<br />Vous pouvez facilement cr&eacute;er un module qui vous permettra de cr&eacute;er des articles, les lister, les &eacute;diter et les supprimer.<br />On appelle aussi &ccedil;a le CRUD : Create Read Update Delete, et la, le builder va vous y aider.<br />Pour cela cliquez sur &quot;Cr&eacute;er un module CRUD&quot;<br /><img src="data/img/builder_blog_crudguriddo.png" /><br />Le builder vous accompagne, il vous indique de t&eacute;l&eacute;charger le module et le d&eacute;sarchiver dans le r&eacute;pertoire module de votre application<br /><img src="data/img/builder_blog_crudguriddo2.png" /><br />Puis r&eacute;actualisez<br /><img src="data/img/builder_blog_crudguriddo3.png" /><br />Le builder vous indique avoir remarqu&eacute; la pr&eacute;sence du module Guriddo dans votre r&eacute;pertoire module/<br />Il vous demande de copier le sous r&eacute;pertoire Guriddo dans le r&eacute;pertoire public de votre application<br /><br /><img src="data/img/builder_blog_crudguriddo4.png" /><br />S&eacute;lectionnez votre classe mod&egrave;le, ici model_author<br /><br /><img src="data/img/builder_blog_crudguriddo5.png" /><br />Le builde vous demande de copier une m&eacute;thode dans la classe mod&egrave;le, il y en aura 4 au total permettant la pagination et le filtrage.<br /><br />La premi&egrave;re r&eacute;cup&egrave;re le nombre total d&#039;enregistrements<br /><br /><img src="data/img/builder_blog_crudguriddo6.png" /><br />La seconde retourne de mani&egrave;re pagin&eacute;e les enregistrements<br /><br /><img src="data/img/builder_blog_crudguriddo7.png" /><br />On fait de m&ecirc;me avec les filtres<br /><br /><img src="data/img/builder_blog_crudguriddo8.png" /><br />La quatri&egrave;me et derni&egrave;re m&eacute;thode<br /><br /><img src="data/img/builder_blog_crudguriddo9.png" /><br /><br />On voit sur cet &eacute;cran la liste des champs de notre table, avec une checkbox permettant de chosir ceux &agrave; afficher dans notre CRUD.<br />Note: contrairement au g&eacute;n&eacute;rateur CRUD, vous avez ici des options en plus: choix de la limite et dimensions du tableau.<br />On clique sur le bouton &quot;cr&eacute;er&quot;<br /><br /><img src="data/img/builder_blog_crudguriddo10.png" /><br />Et voila le crud de votre table article est g&eacute;n&eacute;r&eacute;<br />Au menu:<br />- Create: un lien plus une page contenant un formulaire d&#039;ajout<br />- Read: une page contenant un tableau listant les &eacute;l&eacute;ments de la table<br />- Update: un lien plus une page contenant un formulaire de modification<br />- Delete: un lien plus une page de confirmation de suppression<br /><br />Et ainsi vous avez un tableau Guriddo ainsi que les formulaires d&#039;ajout/modification et suppression<br /><img src="data/img/builder_blog_crudguriddo11.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="crudmulti" name="crudmulti"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Cr&eacute;er un module CRUD multi-ligne (Create Read Update Delete)</h1>Apr&egrave;s avoir cr&eacute;&eacute; votre application, configurer son fichier de connexion et g&eacute;n&eacute;r&eacute; la partie model.<br />Vous pouvez facilement cr&eacute;er un module qui vous permettra de cr&eacute;er des articles, les lister, les &eacute;diter et les supprimer.<br />On appelle aussi &ccedil;a le CRUD : Create Read Update Delete, et la, le builder va vous y aider.<br />Pour cela cliquez sur &quot;Cr&eacute;er un module CRUD&quot;<br /><img src="data/img/crudMulti0.png" /><br />Cliquez ensuite sur la classe mod&egrave;le &agrave; utiliser: ici model_contacts<br /><img src="data/img/crudMulti1.png" /><br />On voit sur cet &eacute;cran la liste des champs de notre table, avec une checkbox permettant de chosir ceux &agrave; afficher dans notre CRUD.<br />On clique sur le bouton &quot;cr&eacute;er&quot;<br /><img src="data/img/crudMulti2.png" /><br />Et voila le crud de votre table article est g&eacute;n&eacute;r&eacute;<br />Au menu:<br />- Create: un lien plus une page contenant un formulaire d&#039;ajout<br />- Read: une page contenant un tableau listant les &eacute;l&eacute;ments de la table<br />- Update: un lien plus une page contenant un formulaire de modification<br />- Delete: un lien plus une page de confirmation de suppression<br /><img src="data/img/crudMulti3.png" /><br />Ce qui donnera comme pour un CRUD &quot;normal&quot; un tableau<br /><img src="data/img/crudMulti4.png" /><br />Avec un petit &quot;plus&quot; un lien permettant de le passer en &quot;modification&quot; multi-ligne<br /><img src="data/img/crudMulti5.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="aclmultigroupes" name="aclmultigroupes"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Ajouter une gestion de permissions multi-groupes (ACL)</h1>Vous souhaitez mettre en place une gestion de droits multi-groupes ?<br />Le builder va vous simplifier la vie<br />Cliquez sur le lien concern&eacute;<br /><img src="data/img/aclMulti0.png" /><br />Le builder vous affiche un sch&eacute;ma des tables qu&#039;il va falloir cr&eacute;er<br />Il vous propose &eacute;galement un exemple de requete Mysql pour cr&eacute;er ces tables.<br /><img src="data/img/aclMulti1.png" /><br />Une fois ces tables cr&eacute;es, il vous faut cr&eacute;er la couche mod&egrave;le, n&eacute;cessaire &agrave; la suite.<br /><br />C&#039;est &agrave; ce moment, (si ce n&#039;est pas d&eacute;j&agrave; fait) que vous devez ajouter/generer l&#039;authentification sur votre application.<br />Il y a des slides si besoin ici <a href="slides.html">ici </a><br /><br />Puis en revenant sur cette nouvelle page.<br /><img src="data/img/aclMulti2.png" /><br />Les menus d&eacute;roulants sont d&eacute;sormais aliment&eacute;es par vos classes model.<br /><img src="data/img/aclMulti3.png" /><br />Selectionnez pour chacun des menus d&eacute;roulants la classe associ&eacute;e, puis dans chacun des sous menu d&eacute;roulants les champs.<br />Tout ceci en rapport avec le sch&eacute;ma au dessus.<br /><img src="data/img/aclMulti4.png" /><br />Une fois fini, cliquez sur &quot;G&eacute;n&eacute;rer&quot;<br /><img src="data/img/aclMulti5.png" /><br />Le builder g&eacute;n&egrave;re une classe mod&egrave;le ainsi qu&#039;un module permettant d&#039;administrer ces droits.<br />Il vous indique &eacute;galement un code &agrave; copier dans votre module d&#039;authentification<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">checkLoginPass</span><span style="color: #007700">(){<br />(...)<br /></span><span style="color: #0000BB">$oUser</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getAccount</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">model_rightsManagerMulti</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">loadForUser</span><span style="color: #007700">(</span><span style="color: #0000BB">$oUser</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'privatemodule_action'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Ce module (accessible via le lien)<br /><img src="data/img/aclMulti6.png" /><br />En cliquant sur ajouter une permission:<br /><img src="data/img/aclMulti7.png" /><br />Vous avez &eacute;galement un formulaire pour ajouter/modifier les groupes d&#039;un utilisateur<br /><img src="data/img/aclMulti8.png" /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="phpexcel" name="phpexcel"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Generer des fichiers excel avec PhpExcel</h1>Nous allons ici g&eacute;n&eacute;rer un fichier excel en s&#039;appuyant sur la librairie PHP connu: PhpExcel<br /><br /><h2>Installation</h2>Rendez-vous sur le site de https://phpexcel.codeplex.com/ pour t&eacute;l&eacute;charger le zip<br />A la racine de votre projet, cr&eacute;er un repertoire &quot;lib&quot; qui contiendra vos librairie excterne, ici phpExcel.<br />Ensuite dans ce r&eacute;pertoire lib cr&eacute;er un repertoire &quot;phpExcel&quot; et d&eacute;sarchiver la librarie t&eacute;l&eacute;charg&eacute;e &agrave; l&#039;int&eacute;rieur.<br />Vous vous retrouvez avec l&#039;arborescence suivante:<br />conf/<br />module/<br />model/<br />(...)<br />lib/<br />lib/phpExcel<br />lib/phpExcel/Classes<br />lib/phpExcel/Documentation<br />lib/phpExcel/Documentation/Examples<br />(...)<br />public/<br /><br /><h2>Utilisation</h2>Dans votre module, d&egrave;s la premi&egrave;re ligne de votre fichier, faites une inclusion de la librairie<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">include(</span><span style="color: #DD0000">'../lib/phpExcel/Classes/PHPExcel.php'</span><span style="color: #007700">);<br /><br />class&nbsp;</span><span style="color: #0000BB">module_default&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ensuite pour utiliser, il vous suffit de suivre les tutoriels du site, par exemple pour faire un simple tableau excel:<br /><br />Un exemple ici pour g&eacute;n&eacute;rer et forcer le t&eacute;l&eacute;chargement d&#039;un excel<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_index</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PHPExcel</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;ecrit&nbsp;ici&nbsp;sur&nbsp;la&nbsp;premiere&nbsp;feuille&nbsp;excel<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setActiveSheetIndex</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #0000BB">setCellValue</span><span style="color: #007700">(</span><span style="color: #DD0000">'A1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Hello'</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #0000BB">setCellValue</span><span style="color: #007700">(</span><span style="color: #DD0000">'B2'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'world!'</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #0000BB">setCellValue</span><span style="color: #007700">(</span><span style="color: #DD0000">'C1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Hello'</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #0000BB">setCellValue</span><span style="color: #007700">(</span><span style="color: #DD0000">'D2'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'world!'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//on&nbsp;force&nbsp;le&nbsp;telechargement&nbsp;en&nbsp;indiquant&nbsp;au&nbsp;navigateur&nbsp;que&nbsp;c'est&nbsp;un&nbsp;fichier&nbsp;excel<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type:&nbsp;application/vnd.ms-excel'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Disposition:&nbsp;attachment;filename="01simple.xls"'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Cache-Control:&nbsp;max-age=0'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;If&nbsp;you're&nbsp;serving&nbsp;to&nbsp;IE&nbsp;9,&nbsp;then&nbsp;the&nbsp;following&nbsp;may&nbsp;be&nbsp;needed<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Cache-Control:&nbsp;max-age=1'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;If&nbsp;you're&nbsp;serving&nbsp;to&nbsp;IE&nbsp;over&nbsp;SSL,&nbsp;then&nbsp;the&nbsp;following&nbsp;may&nbsp;be&nbsp;needed<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">'Expires:&nbsp;Mon,&nbsp;26&nbsp;Jul&nbsp;1997&nbsp;05:00:00&nbsp;GMT'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;Date&nbsp;in&nbsp;the&nbsp;past<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">'Last-Modified:&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">gmdate</span><span style="color: #007700">(</span><span style="color: #DD0000">'D,&nbsp;d&nbsp;M&nbsp;Y&nbsp;H:i:s'</span><span style="color: #007700">).</span><span style="color: #DD0000">'&nbsp;GMT'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;always&nbsp;modified<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">'Cache-Control:&nbsp;cache,&nbsp;must-revalidate'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;HTTP/1.1<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">'Pragma:&nbsp;public'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;HTTP/1.0<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objWriter&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">PHPExcel_IOFactory</span><span style="color: #007700">::</span><span style="color: #0000BB">createWriter</span><span style="color: #007700">(</span><span style="color: #0000BB">$objPHPExcel</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Excel5'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objWriter</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">(</span><span style="color: #DD0000">'php://output'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="multiStep" name="multiStep"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Formulaire multi-step</h1>Nous allons ici cr&eacute;er un formulaire multi-step<br />- step 1: le premier formulaire cr&eacute;era le compte,<br />- step 2: l&#039;adresse de facturation<br />- enfin step 3: l&#039;adresse de livraison<br /><br /><h2>Pr&eacute;paration</h2>La base de test, comprenant deux tables : une table comptes et l&#039;autre adresses<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">comptes</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">c_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">nom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">prenom</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">c_id</span><span style="color: #007700">`)<br />);<br /><br /></span><span style="color: #0000BB">CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">addresses</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">a_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">libelle</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">addresse</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">codepostal</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">ville</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">compte_id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">a_id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Cr&eacute;er les deux tables ainsi que la couche mod&egrave;le (se r&eacute;f&eacute;rer <a href="tutoriaux.html#model">ici </a> )<br /><br /><h2>Cr&eacute;ation du module</h2>Nous cr&eacute;ons ici un module &quot;steps&quot; avec les m&eacute;thodes etape1,etape2 et etape3<br /><br />Dans la m&eacute;thode before, on d&eacute;marre la session:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">module_steps&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">abstract_module</span><span style="color: #007700">{<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">before</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//demarrage&nbsp;de&nbsp;la&nbsp;session<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">startSession</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_layout</span><span style="color: #007700">(</span><span style="color: #DD0000">'template1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />L&#039;id&eacute;e est la suivante:<br />Premier formulaire Step 1 : saisi compte<br />- on affiche le formulaire de saisi du compte<br />- si les donn&eacute;es envoy&eacute;s ne sont pas correctes, on retourne les erreurs pour les afficher dans le formulaire<br />- si elles sont correctes, on enregistre l&#039;objet en session, et l&#039;on redirige vers le Step 2<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_etape1</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processEtape1</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(isset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oCompte'</span><span style="color: #007700">])){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">=</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oCompte'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_comptes</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oCompte</span><span style="color: #007700">=</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$tMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processEtape1</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;array(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_comptes</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tColumn</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">,</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tColumn&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oCompte'</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//une&nbsp;fois&nbsp;enregistre&nbsp;on&nbsp;redirige&nbsp;(vers&nbsp;la&nbsp;page&nbsp;liste)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape2'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et la vue etape1 associ&eacute;e: view/etape1.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$oForm</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_form</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oCompte</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setMessage</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;form&nbsp;action=""&nbsp;method="POST"&nbsp;&gt;<br />&lt;h1&gt;Compte&lt;/h2&gt;<br />&lt;table&nbsp;class="tb_new"&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;nom&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'nom'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;prenom&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'prenom'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;p&gt;&lt;input&nbsp;type="submit"&nbsp;value="Ajouter"&nbsp;/&gt;&nbsp;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::list'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Retour&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&lt;/table&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><img src="data/img/tutoMultiStepEtape1.png" /><br /><br /><br />Second formulaire Step 2 : saisi adresse de facturation<br />- on affiche le formulaire de saisi de l&#039;adresse de facturation<br />- si les donn&eacute;es envoy&eacute;s ne sont pas correctes, on retourne les erreurs pour les afficher dans le formulaire<br />- si elles sont correctes, on enregistre l&#039;objet en session, et l&#039;on redirige vers le Step 3<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_etape2</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processEtape2</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(isset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oAdresseFacturation'</span><span style="color: #007700">])){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">=</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oAdresseFacturation'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_addresses</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape2'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAdresse</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAdresse</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$tMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processEtape2</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;array(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_addresses</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tColumn</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'libelle'</span><span style="color: #007700">,</span><span style="color: #DD0000">'addresse'</span><span style="color: #007700">,</span><span style="color: #DD0000">'codepostal'</span><span style="color: #007700">,</span><span style="color: #DD0000">'ville'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compte_id'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tColumn&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oAdresseFacturation'</span><span style="color: #007700">]=</span><span style="color: #0000BB">$oAdresse</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//une&nbsp;fois&nbsp;enregistre&nbsp;on&nbsp;redirige&nbsp;(vers&nbsp;la&nbsp;page&nbsp;liste)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape3'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et la vue etape1 associ&eacute;e: view/etape2.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$oForm</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_form</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAdresse</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setMessage</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;form&nbsp;action=""&nbsp;method="POST"&nbsp;&gt;<br />&lt;h1&gt;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape1'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Compte&lt;/a&gt;&nbsp;&amp;gt;&amp;gt;&nbsp;Adresse&nbsp;Facturation&nbsp;&lt;/h1&gt;<br />&lt;table&nbsp;class="tb_new"&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;libelle&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'libelle'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;addresse&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'addresse'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;codepostal&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'codepostal'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;ville&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'ville'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;p&gt;&lt;input&nbsp;type="submit"&nbsp;value="Ajouter"&nbsp;/&gt;&nbsp;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::list'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Retour&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&lt;/table&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><img src="data/img/tutoMultiStepEtape2.png" /><br /><br />Dernier formulaire Step 3 : saisi adresse de livraison<br />- on affiche le formulaire de saisi de l&#039;adresse de livraison<br />- si les donn&eacute;es envoy&eacute;s ne sont pas correctes, on retourne les erreurs pour les afficher dans le formulaire<br />- si elles sont correctes, on enregistre en base l&#039;objet compte et adresse de facturation et livraison<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_etape3</span><span style="color: #007700">(){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processEtape3</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_addresses</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape3'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAdresse</span><span style="color: #007700">=</span><span style="color: #0000BB">$oAdresse</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">=</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$tMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processEtape3</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){&nbsp;</span><span style="color: #FF8000">//si&nbsp;ce&nbsp;n'est&nbsp;pas&nbsp;une&nbsp;requete&nbsp;POST&nbsp;on&nbsp;ne&nbsp;soumet&nbsp;pas<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oPluginXsrf</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">checkToken</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">)&nbsp;)&nbsp;){&nbsp;</span><span style="color: #FF8000">//on&nbsp;verifie&nbsp;que&nbsp;le&nbsp;token&nbsp;est&nbsp;valide<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;array(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$oPluginXsrf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">row_addresses</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tColumn</span><span style="color: #007700">=array(</span><span style="color: #DD0000">'libelle'</span><span style="color: #007700">,</span><span style="color: #DD0000">'addresse'</span><span style="color: #007700">,</span><span style="color: #DD0000">'codepostal'</span><span style="color: #007700">,</span><span style="color: #DD0000">'ville'</span><span style="color: #007700">,</span><span style="color: #DD0000">'compte_id'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$tColumn&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #0000BB">$sColumn</span><span style="color: #007700">,</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isValid</span><span style="color: #007700">()){<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//adresse&nbsp;livraison&nbsp;ok,&nbsp;adresse&nbsp;facturation&nbsp;ok&nbsp;et&nbsp;compte&nbsp;ok,&nbsp;on&nbsp;enregistre<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">=</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oCompte'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresseFacturation</span><span style="color: #007700">=</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'oAdresseFacturation'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresseFacturation</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">compte_id</span><span style="color: #007700">=</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">c_id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresseFacturation</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">compte_id</span><span style="color: #007700">=</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">c_id</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oAdresse</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//une&nbsp;fois&nbsp;enregistre&nbsp;on&nbsp;redirige&nbsp;(vers&nbsp;la&nbsp;page&nbsp;liste)<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else{<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$oCompte</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getListError</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>La vue est la m&ecirc;me que etape2. (m&ecirc;me formulaire de renseignement de l&#039;adresse)<br />Et la vue etape1 associ&eacute;e: view/etape3.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php<br />$oForm</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_form</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oAdresse</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setMessage</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tMessage</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;form&nbsp;action=""&nbsp;method="POST"&nbsp;&gt;<br />&lt;h1&gt;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape1'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Compte&lt;/a&gt;&nbsp;&amp;gt;&amp;gt;&nbsp;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape2'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Adresse&nbsp;Facturation&lt;/a&gt;&nbsp;&amp;gt;&amp;gt;&nbsp;Adresse&nbsp;Livraison&nbsp;&lt;/h1&gt;<br /><br />&lt;table&nbsp;class="tb_new"&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;libelle&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'libelle'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;addresse&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'addresse'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;codepostal&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'codepostal'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;ville&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputText</span><span style="color: #007700">(</span><span style="color: #DD0000">'ville'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;p&gt;&lt;input&nbsp;type="submit"&nbsp;value="Ajouter"&nbsp;/&gt;&nbsp;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::list'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Retour&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&lt;/table&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oForm</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getToken</span><span style="color: #007700">(</span><span style="color: #DD0000">'token'</span><span style="color: #007700">,</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">token</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br />On ajoute une page permettant de voir l&#039;ensemble<br />On ajoute dans la classe model model_comptes<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findWithAdresses</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findMany</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;&nbsp;*&nbsp;FROM&nbsp;comptes&nbsp;c&nbsp;INNER&nbsp;join&nbsp;addresses&nbsp;aF&nbsp;ON&nbsp;aF.compte_id=c.c_id&nbsp;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et dan le module, une action _list()<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_list</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;recupere&nbsp;les&nbsp;informations&nbsp;de&nbsp;compte&nbsp;ainsi&nbsp;que&nbsp;les&nbsp;adresses<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tData</span><span style="color: #007700">=</span><span style="color: #0000BB">model_comptes</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findWithAdresses</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::list'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tData</span><span style="color: #007700">=</span><span style="color: #0000BB">$tData</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Et la vue associ&eacute;e view/list.php<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table&nbsp;</span><span style="color: #007700">class=</span><span style="color: #DD0000">"tb_list"</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th&nbsp;colspan</span><span style="color: #007700">=</span><span style="color: #DD0000">"2"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Compte</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th&nbsp;colspan</span><span style="color: #007700">=</span><span style="color: #DD0000">"4"</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Adresse</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Nom</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Prenom</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Type</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Adresse</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">CP</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Ville</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /><br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">tData&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nom?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prenom?&gt;</span>&lt;/td&gt;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">libelle?&gt;</span>&lt;/td&gt;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addresse?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">codepostal?&gt;</span>&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$oData</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ville?&gt;</span>&lt;/td&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endforeach;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/table&gt;<br />&lt;p&gt;&lt;a&nbsp;href="<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getLink</span><span style="color: #007700">(</span><span style="color: #DD0000">'steps::etape1'</span><span style="color: #007700">)</span><span style="color: #0000BB">?&gt;</span>"&gt;Ajouter&nbsp;une&nbsp;entr&amp;eacute;e&lt;/a&gt;&lt;/p&gt;<br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><img src="data/img/tutoMultiStepList.png" /><br /><br /><br /><p><a href="#">Retour en haut de la page</a></p><br /><br /><p><a id="mdpoublie" name="mdpoublie"></a></p><p style="margin:40px 10px">&nbsp;</p><br /><h1>Mot de passe oubli&eacute;</h1><br />Au menu:<br />- cr&eacute;ation de la table Users<br />- cr&eacute;ation de la couche model<br />- cr&eacute;ation du module d&#039;authentification<br />- cr&eacute;ation du formulaire de modification de mot de passe<br />- cr&eacute;ation du formulaire mot de passe oubli&eacute;<br /><br />Commencons par creer la table en base de donn&eacute;es, celle-ci comprendra:<br /><br />Users<br />- USR_Login<br />- USR_Password<br />- USR_Mail<br />- USR_MustUpdatePassword<br /><br />Par exemple pour Mysql<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />CREATE&nbsp;TABLE&nbsp;</span><span style="color: #007700">`</span><span style="color: #DD0000">Users</span><span style="color: #007700">`&nbsp;(<br />`</span><span style="color: #DD0000">id</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">11</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL&nbsp;auto_increment</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">USR_Login</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">USR_Password</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">USR_Mail</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">varchar</span><span style="color: #007700">(</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br />`</span><span style="color: #DD0000">USR_MustUpdatePassword</span><span style="color: #007700">`&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">NOT&nbsp;NULL</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">PRIMARY&nbsp;KEY&nbsp;&nbsp;</span><span style="color: #007700">(`</span><span style="color: #DD0000">id</span><span style="color: #007700">`)<br />);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Puis, cr&eacute;ez la couche mod&egrave;le via le builder ( <a href="tutoriaux.html#model"> tutorial ici </a>)<br /><br />Passons maintenant au module d&#039;authentification, dans le Buider, cliquez sur g&eacute;n&eacute;rer un module d&#039;authentification<br /><br /><img src="data/img/tutoMdpOublieAuth0.png" /><br /><br />En selectionnant le menu d&eacute;roulant du mot de passe vous aurez ce message d&#039;information:<br /><br /><img src="data/img/tutoMdpOublieAuth1.png" /><br /><br />Rajoutez les deux m&eacute;thodes n&eacute;cessaires dans la classe model des utilisateurs, puis cliquez sur &quot;r&eacute;actualiser la page&quot;<br /><br /><img src="data/img/tutoMdpOublieAuth2.png" /><br /><br />Validez avec le bouton &quot;G&eacute;n&eacute;rer le  module d&#039;authentification&quot;<br /><br />Vous avez la page de confirmation de cr&eacute;ation du module, ainsi que l&#039;affichage de parametres &agrave; changer dans le fichier de config<br /><br /><img src="data/img/tutoMdpOublieAuth3.png" /><br /><br />Faites les changements indiqu&eacute;s<br /><br />Nous allons maintenant ajouter le formulaire de modification de mot de passe<br /><br />Modifiez le module d&#039;authentification, fichier module/auth/main.php<br /><br />Nous ajoutons une page de modification de mot de passe<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_updatepassword</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processUpdatePassword</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::updatepassword'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sError</span><span style="color: #007700">=</span><span style="color: #0000BB">$sMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processUpdatePassword</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;le&nbsp;formulaire&nbsp;n'est&nbsp;pas&nbsp;envoye&nbsp;on&nbsp;s'arrete&nbsp;la<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sPassword</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'password'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sPasswordConfirmation</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'passwordConfirmation'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">maxPasswordLength</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Mot&nbsp;de&nbsp;passe&nbsp;trop&nbsp;long'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}else&nbsp;if(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">!=</span><span style="color: #0000BB">$sPasswordConfirmation</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Les&nbsp;deux&nbsp;Mot&nbsp;de&nbsp;passe&nbsp;doivent&nbsp;etre&nbsp;identique'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;stoque&nbsp;les&nbsp;mots&nbsp;de&nbsp;passe&nbsp;hashe&nbsp;dans&nbsp;la&nbsp;classe&nbsp;model_Users<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sHashPassword</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Users</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$sPassword</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Users</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getAuth</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">getAccount</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">id&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">USR_Password</span><span style="color: #007700">=</span><span style="color: #0000BB">$sHashPassword</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">USR_MustUpdatePassword</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_root</span><span style="color: #007700">::</span><span style="color: #0000BB">redirect</span><span style="color: #007700">(</span><span style="color: #DD0000">'default::index'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />la vue correspondante dans module/auth/view/updatepassword.php<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Vous&nbsp;devez&nbsp;modifier&nbsp;votre&nbsp;mot&nbsp;de&nbsp;passe</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Mot&nbsp;de&nbsp;passe</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"password"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"password"&nbsp;</span><span style="color: #007700">/&gt;&lt;/</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Confirmer&nbsp;mot&nbsp;de&nbsp;passe</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"password"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"passwordConfirmation"&nbsp;</span><span style="color: #007700">/&gt;&lt;/</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"submit"&nbsp;</span><span style="color: #0000BB">value</span><span style="color: #007700">=</span><span style="color: #DD0000">"Modifier&nbsp;mot&nbsp;de&nbsp;passe"&nbsp;</span><span style="color: #007700">/&gt;&lt;/</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sError</span><span style="color: #007700">!=</span><span style="color: #DD0000">''</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style="color:red"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sError?&gt;</span>&lt;/p&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/form&gt;<br /><br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br />Enfin il reste la page avec le formulaire de mot de passe oubli&eacute;, o&ugrave; on va saisir son email, et nous ecraserons le mot de passe avec un mot de pass au hasard, puis nous enverrons un mail avec ce mot de passe temporaire<br /><br />Avant cela, il nous faut ajouter une methode pour retrouver un utilisateur via son email, ajoutez cette methode dans model/model_Users.php<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findByMail</span><span style="color: #007700">(</span><span style="color: #0000BB">$mail</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sTable</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;WHERE&nbsp;USR_Mail=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$mail&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Enchainons sur le formulaire d&#039;oubli de mot de passe:<br /><br />Ajouter ces deux m&eacute;thodes dans le module auth: module/auth/main.php<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">_passwordlost</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">processPasswordlost</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">_view</span><span style="color: #007700">(</span><span style="color: #DD0000">'auth::passwordlost'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oView</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sMessage</span><span style="color: #007700">=</span><span style="color: #0000BB">$sMessage</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">oLayout</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">'main'</span><span style="color: #007700">,</span><span style="color: #0000BB">$oView</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">private&nbsp;function&nbsp;</span><span style="color: #0000BB">processPasswordlost</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//si&nbsp;le&nbsp;formulaire&nbsp;n'est&nbsp;pas&nbsp;envoye&nbsp;on&nbsp;s'arrete&nbsp;la<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">isPost</span><span style="color: #007700">()&nbsp;){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sMail</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'mail'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//on&nbsp;recherche&nbsp;le&nbsp;user&nbsp;via&nbsp;son&nbsp;email<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Users</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findByMail</span><span style="color: #007700">(</span><span style="color: #0000BB">$sMail</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$oUser</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newMdp</span><span style="color: #007700">=</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'i'</span><span style="color: #007700">).</span><span style="color: #DD0000">'aZ6'</span><span style="color: #007700">.</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'s'</span><span style="color: #007700">).</span><span style="color: #DD0000">'H'</span><span style="color: #007700">.</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'d'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newMdpHashed</span><span style="color: #007700">=</span><span style="color: #0000BB">model_Users</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">hashPassword</span><span style="color: #007700">(</span><span style="color: #0000BB">$newMdp</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">USR_Password</span><span style="color: #007700">=</span><span style="color: #0000BB">$newMdpHashed</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oUser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sMessage</span><span style="color: #007700">=</span><span style="color: #DD0000">'Bonjour,&nbsp;voici&nbsp;votre&nbsp;mot&nbsp;de&nbsp;passe&nbsp;temporaire:&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$newMdp</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">=new&nbsp;</span><span style="color: #0000BB">plugin_mail</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setFrom</span><span style="color: #007700">(</span><span style="color: #DD0000">'votre&nbsp;site'</span><span style="color: #007700">,</span><span style="color: #DD0000">'email@votresite.com'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addTo</span><span style="color: #007700">(</span><span style="color: #0000BB">$sMail</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setSubject</span><span style="color: #007700">(</span><span style="color: #DD0000">'Mot&nbsp;de&nbsp;passe&nbsp;oublie'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setBody</span><span style="color: #007700">(</span><span style="color: #0000BB">$sMessage</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oMail</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">send</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Un&nbsp;mot&nbsp;de&nbsp;passe&nbsp;temporaire&nbsp;vous&nbsp;a&nbsp;ete&nbsp;envoye'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Pas&nbsp;de&nbsp;compte&nbsp;pour&nbsp;cet&nbsp;email'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Ainsi que la page vue correspondante: module/auth/view/passwordlost.php<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Veuillez&nbsp;saisir&nbsp;votre&nbsp;email&nbsp;et&nbsp;valider&nbsp;pour&nbsp;recevoir&nbsp;un&nbsp;mot&nbsp;de&nbsp;passe&nbsp;temporaire</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Email</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"text"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"mail"&nbsp;</span><span style="color: #007700">/&gt;&lt;/</span><span style="color: #0000BB">td</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;/</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;&lt;</span><span style="color: #0000BB">input&nbsp;type</span><span style="color: #007700">=</span><span style="color: #DD0000">"submit"&nbsp;</span><span style="color: #0000BB">value</span><span style="color: #007700">=</span><span style="color: #DD0000">"Recevoir&nbsp;son&nbsp;mot&nbsp;de&nbsp;passe"&nbsp;</span><span style="color: #007700">/&gt;&lt;/</span><span style="color: #0000BB">p</span><span style="color: #007700">&gt;<br /><br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sMessage</span><span style="color: #007700">!=</span><span style="color: #DD0000">''</span><span style="color: #007700">):</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style="font-weight:bold"&gt;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sMessage?&gt;</span>&lt;/p&gt;<br />&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;</span><span style="color: #007700">endif;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/form&gt;<br /><br />&nbsp;&nbsp;&nbsp;</span><br />
</code></div><br />Enfin: n&#039;oubliez pas d&#039;ajouter un lien sur la page de login :<br /><br />En modifiant module/auth/view/login.php<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">form&nbsp;action</span><span style="color: #007700">=</span><span style="color: #DD0000">""&nbsp;</span><span style="color: #0000BB">method</span><span style="color: #007700">=</span><span style="color: #DD0000">"POST"</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">table</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">tr</span><span style="color: #007700">&gt;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">th</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">Nom&nbsp;d</span><span style="color: #DD0000">'utilisateur&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type="text"&nbsp;name="login"&nbsp;autocomplete="off"/&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Mot&nbsp;de&nbsp;passe&lt;/th&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;input&nbsp;type="password"&nbsp;name="password"&nbsp;/&gt;&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;input&nbsp;type="submit"&nbsp;value="Se&nbsp;connecter"&nbsp;/&gt;&nbsp;&lt;a&nbsp;href="&lt;?php&nbsp;echo&nbsp;_root::getLink('</span><span style="color: #0000BB">auth</span><span style="color: #007700">::</span><span style="color: #0000BB">passwordlost</span><span style="color: #DD0000">');?&gt;"&gt;Mot&nbsp;de&nbsp;passe&nbsp;oublie&lt;/a&gt;&lt;/p&gt;<br /><br />&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;if($this-&gt;sError!=''):?&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;style="color:red"&gt;&lt;?php&nbsp;echo&nbsp;$this-&gt;sError?&gt;&lt;/p&gt;<br />&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;endif;?&gt;<br />&lt;/form&gt;<br /><br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div>	 
		</div>	
	 
		</main>
	 
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="site/js/jquery-3.2.1.slim.min.js" ></script>
     <script src="site/js/bootstrap.min.js" ></script>
  </body>
</html>

<!--cache -->