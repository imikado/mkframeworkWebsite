<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="site/css/bootstrap.min_v2.css" />
    
 
    <title>MkFramework</title>
 <link rel="stylesheet" type="text/css" href="site/css/main.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="site/css/jumbotron.css" media="screen" />


  
<script src="site/js/main.js" type="text/javascript"></script>

<link rel="alternate" type="application/rss+xml" title="RSS" href="news.rss"/>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34332613-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<style>
.container2{
margin-top:40px;

}
</style>
</head>
<body>

<style>
.navbar .navbar-brand{
background: url('site/css/images//logoMk.png') no-repeat 0px 0px ;
padding-left:60px;
}
</style>

<nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark">
	<a class="navbar-brand" href="#">MKFramework</a>
	<button class="navbar-toggler p-0 border-0" type="button" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="navbar-toggler-icon"></span>
	</button>
	
 

	<div class="navbar-collapse collapse"  >
		<ul class="navbar-nav mr-auto">
		
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="accueil.html">Accueil <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="news.html">Le site <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item active">
					<a  class="nav-link" href="fonctionnement.html">Pr&eacute;sentation <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="start.html">Documentation <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="publishonweb.html">Publications <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a  class="nav-link" href="telecharger.html">T&eacute;l&eacute;charger <span class="sr-only">(current)</span></a>
				</li>
			
				
				
			
							
				<li class="nav-item ">
					<a target="_blank" class="nav-link" href="http://www.developpez.net/forums/f1355/applications/projets/projets-heberges/mkframework/">Forum <span class="sr-only">(current)</span></a>
				</li>
			
				
				
						
			
          
		</ul>
		
		<ul class="navbar-nav  navbar-right">
						<li class="nav-item"><a class="nav-link" style="font-weight:bold" href="security.html">FR</a></li>

			<li><a class="nav-link"  href="security_en.html">EN</a></li>
		</ul>
		
	</div>
</nav>
 <style>
 .navbar-custom {
    background-color: #124c5c;
}</style>
<nav class="navbar navbar-expand-md  navbar-custom navbar-dark">
	 

	<div class="navbar-collapse collapse"  >
		<ul class="navbar-nav mr-auto">
	
			
	
				
			
			<li class="nav-item ">
				<a class="nav-link" href="fonctionnement.html" >Sch&eacute;mas <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="builder.html" >Le g&eacute;n&eacute;rateur web <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="orm.html" >L'ORM (La couche mod&egrave;le) <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="configuration.html" >Configuration <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item active">
				<a class="nav-link" href="#" >La s&eacute;curit&eacute; <span class="sr-only">(current)</span></a>
			</li>
		
			
			
				
			
			<li class="nav-item ">
				<a class="nav-link" href="scraftsmanship.html" >Software Craftsmanship <span class="sr-only">(current)</span></a>
			</li>
		
			
			
		  
  
         
	</ul>
</div>
</nav>


    
      <main role="main">
      
		<div class="container container2">
	 
		<h1>La s&eacute;curit&eacute; dans le mkframework</h1><h2>Introduction</h2>La s&eacute;curit&eacute; est un point &agrave; ne pas n&eacute;gliger surtout lorsque l&#039;on fait une application web &quot;publique&quot; qui pourra faire l&#039;objet de nombreuses attaques.<br />Pour nous pr&eacute;venir des failles les plus communes (Xss,Xsrf/Sql injection...) il existe des conventions/bonnes pratiques plus ou moins connu des d&eacute;veloppeurs.<br />Travaillant depuis plusieurs ann&eacute;es avec une soci&eacute;t&eacute; de s&eacute;curit&eacute; qui audite certaines de nos applications, j&#039;ai impl&eacute;ment&eacute; au fur et &agrave; mesure ces recommandations sur le mkframework pour vous proposer un framework le plus s&eacute;curis&eacute; possible.<br /><br /><h2>Concernant le Xss/Css/null byte</h2>Le xss consistant &agrave; utiliser un param&egrave;tre (GET/POST...) pour modifier le site, le framework propose d&#039;utiliser la m&eacute;thode _root::getParam() &agrave; la place des variables globales $_GET/$_POST<br />Le contenu retourn&eacute; par _root::getParam() filtre les entr&eacute;es des attaques XSS mais &eacute;galement des attaques de type null byte<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />$id</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//a&nbsp;la&nbsp;place&nbsp;de&nbsp;$id=$_GET['id'];<br />//idem&nbsp;pour&nbsp;le&nbsp;POST<br /></span><span style="color: #0000BB">$titre</span><span style="color: #007700">=</span><span style="color: #0000BB">_root</span><span style="color: #007700">::</span><span style="color: #0000BB">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">'titre'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//a&nbsp;la&nbsp;place&nbsp;de&nbsp;$titre=$_POST['titire'];<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Plus d&#039;informations sur le Xss/Css: <a href="http://fr.wikipedia.org/wiki/Cross-site_scripting">http://fr.wikipedia.org/wiki/Cross-site_scripting </a><br /><br /><br /><h2>Concernant le Xsrf/Csrf</h2>Le xsrf est un peu plus vicieux, il permet de soumettre une requ&ecirc;te &agrave; la place d&#039;un utilisateur, pour vous prot&eacute;ger de cette attaque, le framework propose un plugin: plugin_xsrf.<br />Celui-ci g&eacute;n&egrave;re un jeton et propose une m&eacute;thode pour v&eacute;rifier sa validit&eacute;.<br /><br />note: vous pouvez renforcer cette s&eacute;curit&eacute; en activant la variable xsrf.session.enabled=1 dans la section [security] dans le fichier de configuration conf/site.ini.php<br />Celle-ci n&eacute;cessite d&#039;avoir une session ouverte (le jeton &eacute;tant stoqu&eacute; en session pour garantir son utilisation unique)<br /><br />note 2: pensez &agrave; modifier le sel present dans le constructeur du plugin plugin_xsrf<br />Modifiez cette propri&eacute;t&eacute; pour la rendre unique:<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">plugin_xsrf</span><span style="color: #007700">(){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sSalt</span><span style="color: #007700">=</span><span style="color: #DD0000">'fdsfhoyu679hjfdsAfef'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">(...)<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Tutorial ici <a href="http://mkdevs.com/tutoriaux.html#token">http://mkdevs.com/tutoriaux.html#token </a><br /><br />Plus d&#039;informations sur le Xsrf/Csrf: <a href="http://fr.wikipedia.org/wiki/Cross-site_request_forgery">http://fr.wikipedia.org/wiki/Cross-site_request_forgery </a><br /><br /><br /><h2>Concernant l&#039;injection SQL</h2>L&#039;injection consistant &agrave; profiter d&#039;une requ&ecirc;te pour en modifier le but (r&eacute;cup&eacute;rer les identifiants, faire des modifications en base...).<br />Le framework utilise les &quot;prepared statement&quot; de Pdo pour vous prot&eacute;ger de ce type d&#039;attaque.<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #FF8000">//pour&nbsp;une&nbsp;requete&nbsp;recuperant&nbsp;un&nbsp;auteur&nbsp;par&nbsp;son&nbsp;id<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">findById</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">){<br /></span><span style="color: #0000BB">&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;FOM&nbsp;auteur&nbsp;WHERE&nbsp;id=?'</span><span style="color: #007700">,</span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br />}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br />Plus d&#039;informations sur l&#039;SQL injection <a href="http://fr.wikipedia.org/wiki/Injection_SQL">http://fr.wikipedia.org/wiki/Injection_SQL </a><br /><br /><h1>Les bonnes pratiques non impl&eacute;ment&eacute;es dans le framework, &agrave; la charge du d&eacute;veloppeur</h1><h2>D&eacute;sactivez l&#039;auto compl&eacute;tion sur les champs d&#039;identification</h2>Il est recommand&eacute; d&#039;utiliser l&#039;attribut autocomplete=&quot;off&quot; dans vos champs input d&#039;authentification.<br />Les internautes peuvent se connecter via des sites &quot;publiques&quot; (cyber caf&eacute;, hotels...) et il serait peu s&eacute;curis&eacute; que le login soit enregistr&eacute; sur l&#039;ordinateur.<br /><br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">input&nbsp;autocomplete</span><span style="color: #007700">=</span><span style="color: #DD0000">"off"&nbsp;</span><span style="color: #0000BB">name</span><span style="color: #007700">=</span><span style="color: #DD0000">"utilisateur"&nbsp;</span><span style="color: #007700">/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div><br /><h2>Passez votre site en mode production</h2>Editez le fichier conf/mode.ini.php<br />Et mettez en valeur &quot;production&quot; plutot que &quot;dev&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br /></span><span style="color: #007700">[</span><span style="color: #0000BB">site</span><span style="color: #007700">]<br /></span><span style="color: #0000BB">mode</span><span style="color: #007700">=</span><span style="color: #0000BB">production<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div>Ceci permet de cacher les erreurs php, &agrave; la place, ils sont ajout&eacute;s dans le fichier de log<br />Vous pouvez d&#039;ailleurs param&eacute;trer dans le ficheir conf/site.ini.php o&ugrave; consigner les erreurs de &quot;production&quot;<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />file</span><span style="color: #007700">.</span><span style="color: #0000BB">enabled</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />apache</span><span style="color: #007700">.</span><span style="color: #0000BB">enabled</span><span style="color: #007700">=</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;</span><br />
</span><br />
</code></div><br /><h2>G&eacute;rer une politique de mauvaise authentification</h2>Afin d&#039;&eacute;viter les intrusions par &quot;brute force&quot;, il faut pour limiter ce type d&#039;attaque:<br />- bloquer totalement un compte au bout d&#039;un nombre d&#039;authentification infructueuse<br />- suspendre le compte pendant un temps d&eacute;fini (l&#039;obligeant &agrave; attendre pour se connecter)<br />- ajouter un Captcha en cas d&#039;erreur, qui limitera les robots de &quot;brute force&quot;<br />- selon un nombre de tentatives de connexions/minute: interdire l&#039;IP utilis&eacute; par l&#039;auteur<br /><br />note: attention au blocage de compte, ils peuvent &ecirc;tre utilis&eacute;e pour des attaques DDOS* (en bloquant l&#039;ensemble des comptes)<br />note 2: afin d&#039;&eacute;viter les DDOS sur le hashage de mot de passe, v&eacute;rifier que le mot de passe propos&eacute; ne d&eacute;passe pas au minimum 100 caract&egrave;res: sinon on peut vous envoyer en boucle des mots de passe de N milliers de caract&egrave;res que votre serveur mettra du temps &agrave; hasher pour faire tomber celui-ci<br />Note 3: le g&eacute;n&eacute;rateur web (builder) permet de g&eacute;n&eacute;rer un module d&#039;authentification<br /><br />Plus d&#039;informations sur le DDOS <a href="http://fr.wikipedia.org/wiki/Attaque_par_d%C3%A9ni_de_service">http://fr.wikipedia.org/wiki/Attaque_par_d%C3%A9ni_de_service </a><br /><br /><h2>Bien g&eacute;rer l&#039;isolation des donn&eacute;es</h2>Sur un site web de gestion d&#039;email par exemple, il ne serait pas agr&eacute;able qu&#039;un utilisateur puisse voir ou r&eacute;pondre aux emails d&#039;un autre.<br />Pour cela, il faut g&eacute;rer l&#039;isolation des donn&eacute;es: v&eacute;rifier &agrave; chaque fois que vous listez des donn&eacute;es ou affichez le d&eacute;tail de l&#039;une d&#039;entre elles qu&#039;elle appartient bien &agrave; l&#039;utilisateur connect&eacute;.<br /><br /><h2>Interdire la mise en frame/iframe de votre site web</h2>Si un site hack&eacute; inclut une iframe vers un formulaire de votre site, et qu&#039;un utilisateur connect&eacute; dans un autre onglet se rend sur le site, le hackeur peut, via javascript soumettre le formulaire &agrave; l&#039;insu de l&#039;internaute.<br />Pour cela, apache inclut une directive prise en compte par la majorit&eacute; des navigateurs ( sup&eacute;rieur &agrave; ie7)<br /><div class="code"> <code><span style="color: #000000"><br />
<span style="color: #0000BB">&nbsp;&nbsp;<br />Header&nbsp;set&nbsp;X</span><span style="color: #007700">-</span><span style="color: #0000BB">Frame</span><span style="color: #007700">-</span><span style="color: #0000BB">Options</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">"sameorigin"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000B"></span><br />
</span><br />
</code></div>Qui peut prendre plusieurs valeurs: m&ecirc;me domaine autoris&eacute;, non autoris&eacute;...<br /><br /><h2>Conclusion</h2>Comme vous avez pu le lire, je continue r&eacute;guli&egrave;rement &agrave; faire de la veille sur la s&eacute;curit&eacute; et prendre en compte les recommandations de soci&eacute;t&eacute; de s&eacute;curit&eacute; avec qui nous travaillons.<br />	 
		</div>	
	 
		</main>
	 
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="site/js/jquery-3.2.1.slim.min.js" ></script>
     <script src="site/js/bootstrap.min.js" ></script>
  </body>
</html>

<!--cache -->